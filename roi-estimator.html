<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ğŸ“ˆ SmartWerk ROI Estimator</title>
  <link rel="stylesheet" href="style-roi.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <nav class="left">
    <a href="dashboard.html" class="btn ghost">â† Back to Dashboard</a>
    <a href="templates.html" class="btn ghost">â† Back to Templates</a>
  </nav>
  <div class="container">
    <h1>ğŸ“ˆ ROI Estimator â€” SmartWerk PRO</h1>
    <p>Estimate the return on investment for your freelance or business expenses.</p>

    <form id="roiForm">
      <div class="form-group">
        <label for="initialInvestment">ğŸ’° Initial Investment (â‚¬)</label>
        <input type="number" id="initialInvestment" placeholder="e.g. 1000" required />
      </div>
      <div class="form-group">
        <label for="monthlyProfit">ğŸ“ˆ Monthly Profit Increase (â‚¬)</label>
        <input type="number" id="monthlyProfit" placeholder="e.g. 250" required />
      </div>
      <div class="form-group">
        <label for="duration">ğŸ• Period (in months)</label>
        <input type="number" id="duration" placeholder="e.g. 6" required />
      </div>
      <div class="form-group">
        <label for="extraCosts">ğŸ’¸ Extra Costs (Optional) (â‚¬)</label>
        <input type="number" id="extraCosts" placeholder="e.g. 100" />
      </div>
      <div class="form-actions">
        <button type="button" class="btn primary" id="calculateROI">ğŸ“Š Calculate ROI</button>
        <button type="button" class="btn" id="exportPDF">ğŸ“„ Export PDF</button>
        <button type="button" class="btn pro" id="exportPDFNoBranding">PRO ğŸ“„ Export without branding</button>
      </div>
    </form>

    <section id="results" style="display:none;">
      <h2>ğŸ“Š Results</h2>
      <p><strong>Total Profit:</strong> <span id="totalProfit">â€”</span> â‚¬</p>
      <p><strong>ROI:</strong> <span id="roiResult">â€”</span> %</p>
      <p><strong>Payback Period:</strong> <span id="paybackPeriod">â€”</span> months</p>
    </section>

    <section id="chartSection" style="margin-top: 40px;">
      <h3>ğŸ“ˆ ROI Growth Chart</h3>
      <canvas id="roiChart"></canvas>
    </section>

    <section id="tipsSection" style="margin-top: 40px;">
      <h3>ğŸ§  Smart Suggestions</h3>
      <ul id="smartTips"></ul>
    </section>
  </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const form = document.getElementById("roiForm");
  const result = document.getElementById("roiResult");
  const payback = document.getElementById("paybackPeriod");
  const totalProfitEl = document.getElementById("totalProfit");
  const tips = document.getElementById("smartTips");
  const chartCanvas = document.getElementById("roiChart");
  let chart;

  function calculateROI() {
    const investment = parseFloat(document.getElementById("initialInvestment").value) || 0;
    const monthlyProfit = parseFloat(document.getElementById("monthlyProfit").value) || 0;
    const duration = parseInt(document.getElementById("duration").value) || 1;
    const extraCosts = parseFloat(document.getElementById("extraCosts").value) || 0;

    const totalProfit = monthlyProfit * duration;
    const netProfit = totalProfit - investment - extraCosts;
    const roiPercent = investment > 0 ? ((netProfit / investment) * 100).toFixed(2) : 0;
    const paybackMonths = monthlyProfit > 0 ? Math.ceil((investment + extraCosts) / monthlyProfit) : "âˆ";

    document.getElementById("results").style.display = "block";
    totalProfitEl.textContent = totalProfit.toFixed(2);
    result.textContent = roiPercent;
    payback.textContent = paybackMonths;

    generateChart(investment + extraCosts, totalProfit);
    generateSmartTips(roiPercent, netProfit);
  }

  function generateSmartTips(roi, profit) {
    tips.innerHTML = "";
    if (roi < 0) {
      tips.innerHTML += "<li>âŒ Loss-making investment. Reevaluate costs.</li>";
    } else if (roi < 20) {
      tips.innerHTML += "<li>âš ï¸ Low ROI. Consider reducing costs or increasing value.</li>";
    } else if (roi < 100) {
      tips.innerHTML += "<li>âœ… Moderate ROI. Monitor before scaling.</li>";
    } else {
      tips.innerHTML += "<li>ğŸš€ High ROI! Consider scaling further.</li>";
    }
  }

  function generateChart(costs, profit) {
    const ctx = chartCanvas.getContext("2d");
    if (chart) chart.destroy();
    chart = new Chart(ctx, {
      type: "bar",
      data: {
        labels: ["Total Costs", "Total Profit"],
        datasets: [{
          label: "â‚¬ Value",
          data: [costs, profit],
          backgroundColor: ["#e74c3c", "#2ecc71"]
        }]
      },
      options: {
        plugins: {
          legend: { display: false },
          title: { display: true, text: "Investment vs Profit" }
        }
      }
    });
  }

  async function exportToPDF(withBranding = true) {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const investment = parseFloat(document.getElementById("initialInvestment").value) || 0;
    const monthlyProfit = parseFloat(document.getElementById("monthlyProfit").value) || 0;
    const duration = parseInt(document.getElementById("duration").value) || 1;
    const extraCosts = parseFloat(document.getElementById("extraCosts").value) || 0;

    const totalProfit = monthlyProfit * duration;
    const netProfit = totalProfit - investment - extraCosts;
    const roiPercent = investment > 0 ? ((netProfit / investment) * 100).toFixed(2) : 0;
    const paybackMonths = monthlyProfit > 0 ? Math.ceil((investment + extraCosts) / monthlyProfit) : "âˆ";

    doc.setFontSize(18);
    doc.text("SmartWerk ROI Report", 20, 20);
    doc.setFontSize(12);
    doc.text(`Initial Investment: â‚¬${investment.toFixed(2)}`, 20, 40);
    doc.text(`Monthly Profit: â‚¬${monthlyProfit.toFixed(2)}`, 20, 50);
    doc.text(`Duration: ${duration} months`, 20, 60);
    doc.text(`Extra Costs: â‚¬${extraCosts.toFixed(2)}`, 20, 70);
    doc.text(`Total Profit: â‚¬${totalProfit.toFixed(2)}`, 20, 80);
    doc.text(`ROI: ${roiPercent}%`, 20, 90);
    doc.text(`Payback Period: ${paybackMonths} months`, 20, 100);

    if (withBranding) {
      doc.setTextColor(150);
      doc.text("Generated with SmartWerk â€” smartwerk.nl", 105, 290, null, null, "center");
      doc.setTextColor(0);
    }

    doc.save("SmartWerk_ROI_Report.pdf");
  }

  document.getElementById("calculateROI").addEventListener("click", calculateROI);
  document.getElementById("exportPDF").addEventListener("click", () => exportToPDF(true));
  document.getElementById("exportPDFNoBranding").addEventListener("click", () => exportToPDF(false));
});
</script>
</body>
</html>
