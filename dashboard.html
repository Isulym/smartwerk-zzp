<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SmartWerk â€” Dashboard</title>
  <link rel="stylesheet" href="style-dashboard.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">âš¡ SmartWerk</div>
    <nav>
      <div class="accordion">
        <button class="accordion-btn">ğŸ’° Invoices</button>
        <div class="accordion-panel">
          <a href="invoice.html">ğŸ“„ Create Invoice</a>
          <a href="invoices-list.html">ğŸ“‹ Saved Invoices</a>
        </div>

        <button class="accordion-btn">ğŸ“‘ Quotes</button>
        <div class="accordion-panel">
          <a href="quote-offer.html">ğŸ“„ Create Quote</a>
          <a href="quote-offer-list.html">ğŸ“‹ Saved Quotes</a>
        </div>

        <button class="accordion-btn">ğŸ“ƒ Contracts</button>
        <div class="accordion-panel">
          <a href="contract.html">ğŸ“„ Create Contract</a>
          <a href="contract-list.html">ğŸ“‹ Saved Contracts</a>
        </div>

        <button class="accordion-btn">ğŸ“¬ Reminders</button>
        <div class="accordion-panel">
          <a href="payment-reminder.html">ğŸ’¸ Create Reminder</a>
          <a href="payment-reminder-list.html">ğŸ“‹ Saved Reminders</a>
        </div>

        <button class="accordion-btn">ğŸ“‚ Templates</button>
        <div class="accordion-panel">
          <a href="email-gemeente.html">ğŸ“© Email to Gemeente</a>
          <a href="cv.html">ğŸ“„ CV / Portfolio</a>
        </div>

        <button class="accordion-btn">ğŸ“Š Analytics</button>
        <div class="accordion-panel">
          <a href="my-bookkeeper.html">ğŸ† My Bookkeeper</a>
          <a href="summary.html">ğŸ“Š Summary</a>
          <a href="roi-estimator.html">ğŸ§® ROI Estimator</a>
          <a href="tax-calculator.html">ğŸ§® Tax Calculator</a>
        </div>

        <button class="accordion-btn">âš™ï¸ Settings</button>
        <div class="accordion-panel">
          <a href="profile.html">ğŸ‘¤ Profile</a>
        </div>
      </div>
    </nav>
    <button id="logoutBtn" class="logout">ğŸšª Logout</button>
  </aside>

  <!-- Main -->
  <main class="content">
  <header class="topbar">...</header>

  <!-- Quick Actions -->
  <section class="card quick-actions">
    <h2>âš¡ Quick Actions</h2>
    <div class="buttons">
      <button>â• Invoice</button>
      <button>â• Quote</button>
      <button>â• Contract</button>
      <button>â• Reminder</button>
    </div>
  </section>

  <!-- KPI Cards -->
  <section class="kpis">
    <div class="card kpi">ğŸ’° Revenue <span id="kpiRevenue">â‚¬0</span></div>
    <div class="card kpi">ğŸ“„ Invoices <span id="kpiInvoices">0</span></div>
    <div class="card kpi">ğŸ“‘ Quotes <span id="kpiQuotes">0</span></div>
    <div class="card kpi">ğŸ“¬ Reminders <span id="kpiReminders">0</span></div>
    <div class="card kpi">ğŸ‘¥ Clients <span id="kpiClients">0</span></div>
    <div class="card kpi">âš ï¸ Unpaid <span id="kpiUnpaid">0</span></div>
  </section>

  <!-- Charts -->
  <section class="charts">
    <div class="card"><canvas id="revenueChart"></canvas></div>
    <div class="card"><canvas id="invoiceChart"></canvas></div>
  </section>

  <!-- Suggestions -->
  <section class="card suggestions">
    <h2>ğŸ”” Smart Suggestions</h2>
    <ul id="suggestionsList">
      <li>âš ï¸ 2 invoices overdue â†’ Send Reminder</li>
    </ul>
  </section>

  <!-- Activity -->
  <section class="card activity">
    <h2>ğŸ“Œ Recent Activity</h2>
    <ul id="activityList">
      <li>ğŸ“„ Invoice INV-2025-003 created</li>
    </ul>
  </section>
</main>
  
  <!-- Firebase -->
  <script type="module">
    import { initializeApp, getApps, getApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, doc, getDoc, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAp397Ax_jaMI85vOXicOi61g64HvvA_Kg",
      authDomain: "smartwerk8520.firebaseapp.com",
      projectId: "smartwerk8520",
      appId: "1:607670981972:web:c07103c981c86860d724c1",
    };

    const app = getApps().length ? getApp() : initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db   = getFirestore(app);

    // Accordion
    document.querySelectorAll(".accordion-btn").forEach(btn=>{
      btn.addEventListener("click",()=>{
        btn.classList.toggle("active");
        const panel = btn.nextElementSibling;
        panel.style.display = panel.style.display==="block" ? "none" : "block";
      });
    });

    // Load Dashboard Data
    onAuthStateChanged(auth, async(user)=>{
      if(!user){ location.href="login.html"; return; }

      const uid = user.uid;
      const snap = await getDoc(doc(db,"users",uid));
      if(snap.exists()){
        const d = snap.data();
        document.getElementById("welcome").innerText = `ğŸ‘‹ Welcome, ${d.fullName||"User"}`;
        document.getElementById("planName").innerText = d.plan || "FREE";

        // Usage
        const used = d.usage || 0;
        const limit = d.plan==="PRO"?999:25;
        document.getElementById("planUsage").innerText = `${used} / ${limit}`;
        document.getElementById("planProgress").style.width = `${Math.min((used/limit)*100,100)}%`;
      }

      // Logout
      document.getElementById("logoutBtn").onclick=()=>signOut(auth);
    });

    // Dummy Charts
    new Chart(document.getElementById("revenueChart"),{
      type:"line",
      data:{labels:["Jan","Feb","Mar"], datasets:[{label:"Revenue", data:[0,200,400], borderColor:"#3b82f6"}]},
      options:{responsive:true}
    });
    new Chart(document.getElementById("invoiceChart"),{
      type:"doughnut",
      data:{labels:["Paid","Unpaid","Draft"], datasets:[{data:[2,1,3], backgroundColor:["#22c55e","#ef4444","#94a3b8"]}]},
      options:{responsive:true}
    });
  </script>
</body>
</html>
