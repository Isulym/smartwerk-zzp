<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SmartWerk Tax Calculator</title>
  <style>
    body { font-family: sans-serif; padding: 2em; background: #f9f9f9; }
    h2, h3 { color: #333; }
    .section { background: #fff; padding: 20px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 0 8px rgba(0,0,0,0.05); }
    label { display: block; margin-top: 12px; }
    input, select { width: 100%; padding: 8px; margin-top: 4px; }
    .summary { background: #e6ffe6; }
    .button-group { margin-top: 20px; }
    .button-group button { margin-right: 10px; padding: 10px 15px; }
  </style>
</head>
<body>

<h2>SmartWerk Tax Calculator</h2>

<div class="section">
  <h3>Step 1: Your Data</h3>
  <label>Company Name:</label><input type="text" id="companyName">
  <label>Email / Phone:</label><input type="text" id="contactInfo">
  <label>Period:</label>
  <select id="period">
    <option value="Q1">January â€“ March (Q1)</option>
    <option value="Q2">April â€“ June (Q2)</option>
    <option value="Q3">July â€“ September (Q3)</option>
    <option value="Q4">October â€“ December (Q4)</option>
  </select>
  <label>Hours Worked:</label><input type="number" id="hoursWorked" oninput="autoCalcIncome()">
  <label>Hourly Rate (EUR):</label><input type="number" id="hourlyRate" oninput="autoCalcIncome()">
  <label>Total Income (auto):</label><input type="number" id="income" readonly>
</div>

<div class="section">
  <h3>Step 2: Expenses</h3>
  <label>Vehicle Expenses:</label><input type="number" id="vehicle">
  <label>Office Expenses:</label><input type="number" id="office">
  <label>Internet Expenses:</label><input type="number" id="internet">
  <label>Marketing Expenses:</label><input type="number" id="marketing">
  <label>Other Expenses:</label><input type="number" id="other">
  <label>Extra Benefits (EUR):</label><input type="number" id="extraBenefits">
</div>

<div class="section">
  <h3>Step 3: Tax Options</h3>
  <label>KvK Registered?</label>
  <select id="kvk" onchange="calculateAutomatically()">
    <option value="yes">Yes</option>
    <option value="no">No</option>
  </select>
  <label>Worked 1,225+ hours?</label>
  <select id="zzpHours" onchange="calculateAutomatically()">
    <option value="yes">Yes</option>
    <option value="no">No</option>
  </select>
  <label>BTW Rate:</label>
  <select id="btwRate" onchange="calculateAutomatically()">
    <option value="21">21%</option>
    <option value="9">9%</option>
    <option value="0">0%</option>
  </select>
  <label>Use KOR?</label>
  <select id="kor" onchange="calculateAutomatically()">
    <option value="no">No</option>
    <option value="yes">Yes</option>
  </select>
</div>

<div class="section summary">
  <h3>Step 4: Result</h3>
  <div id="result">
    <p>ğŸ’° <strong>Gross Income:</strong> <span id="grossIncome">â€“</span></p>
    <p>ğŸ“‰ <strong>Total Expenses:</strong> <span id="totalExpenses">â€“</span></p>
    <p>ğŸ’¼ <strong>Taxable Profit:</strong> <span id="taxableProfit">â€“</span></p>
    <p>ğŸ›¡ï¸ <strong>ZZP Deductions:</strong> <span id="zzpDeductions">â€“</span></p>
    <p>ğŸ¦ <strong>MKB Exemption (12.7%):</strong> <span id="mkbExemption">â€“</span></p>
    <p>ğŸ“Š <strong>Final Taxable Income:</strong> <span id="finalTaxable">â€“</span></p>
    <p>ğŸ’¸ <strong>Income Tax (19% / 25.8%):</strong> <span id="incomeTax">â€“</span> 
      <span title="Progressive: 19% to â‚¬200K, 25.8% above">â„¹ï¸</span>
    </p>
    <p>ğŸ’¶ <strong>ZVW (5.32%):</strong> <span id="zvwAmount">â€“</span>
      <span title="Mandatory healthcare contribution (ZVW)">â„¹ï¸</span>
    </p>
    <p>ğŸ§® <strong>BTW Amount:</strong> <span id="btwAmount">â€“</span>
      <span title="Based on selected BTW rate">â„¹ï¸</span>
    </p>
    <p>ğŸŸ¢ <strong>Total Estimated Tax:</strong> <span id="totalTax">â€“</span></p>
    <p style="color:green"><strong>âœ… You saved:</strong> <span id="youSaved">â€“</span></p>

    <hr/>
    <div id="deductionBreakdown">
      <h4>ğŸ“Œ Deduction Breakdown</h4>
      <ul>
        <li>âœ”ï¸ Zelfstandigenaftrek: â‚¬5,030 
          <span title="If KvK = yes & 1225+ hrs">â„¹ï¸</span></li>
        <li>âœ”ï¸ Startersaftrek: â‚¬2,123 
          <span title="Only for first 3 years">â„¹ï¸</span></li>
        <li>âœ”ï¸ MKB-vrijstelling: 12.7% 
          <span title="Applied after deductions">â„¹ï¸</span></li>
        <li>âœ”ï¸ KOR: depends on eligibility 
          <span title="Only if turnover is under â‚¬20,000 and selected">â„¹ï¸</span></li>
      </ul>
    </div>
  </div>
</div>
<div class="button-group">
  <button onclick="calculateTax()">ğŸ”„ Calculate Tax</button>
  <button onclick="alert('Export to PDF coming soon')">ğŸ“„ Export PDF</button>
  <button onclick="alert('Ask SmartWerk AI')">ğŸ¤– Ask SmartWerk AI</button>
</div>

<script>
function autoCalcIncome() {
  const h = +document.getElementById("hoursWorked").value || 0;
  const r = +document.getElementById("hourlyRate").value || 0;
  document.getElementById("income").value = h * r;
  calculateAutomatically();
}

function calculateAutomatically() {
  if (typeof calculateTax === "function") {
    calculateTax();
  }
}

function calculateTax() {
  const income = +document.getElementById("income").value || 0;
  const vehicle = +document.getElementById("vehicle").value || 0;
  const office = +document.getElementById("office").value || 0;
  const internet = +document.getElementById("internet").value || 0;
  const marketing = +document.getElementById("marketing").value || 0;
  const other = +document.getElementById("other").value || 0;
  const extraBenefits = +document.getElementById("extraBenefits").value || 0;
  const kvk = document.getElementById("kvk").value === "yes";
  const zzp = document.getElementById("zzpHours").value === "yes";
  const kor = document.getElementById("kor").value === "yes";

  const totalExpenses = vehicle + office + internet + marketing + other;
  const profit = income - totalExpenses + extraBenefits;

  let deductions = 0;
  if (kvk && zzp) {
    deductions += 5030;
    deductions += 2123;
  }

  let taxable = Math.max(0, profit - deductions);
  const mkbVrijstelling = taxable * 0.127;
  taxable -= mkbVrijstelling;

  let incomeTax = 0;
  if (taxable <= 200000) {
    incomeTax = taxable * 0.19;
  } else {
    incomeTax = 200000 * 0.19 + (taxable - 200000) * 0.258;
  }

  const zvw = profit * 0.0532;
  if (kor) incomeTax *= 0.8;

  const totalTax = incomeTax + zvw;
  const totalSaved = deductions + mkbVrijstelling;

  document.getElementById("result").innerHTML = `
    ğŸ’¼ <b>Profit:</b> â‚¬${profit.toFixed(2)}<br>
    ğŸ“‰ <b>Deductions:</b> â‚¬${deductions.toFixed(2)}<br>
    ğŸ¦ <b>MKB Exemption (12.7%):</b> â‚¬${mkbVrijstelling.toFixed(2)}<br>
    ğŸ’¸ <b>Income Tax:</b> â‚¬${incomeTax.toFixed(2)}<br>
    ğŸ¥ <b>ZVW (5.32%):</b> â‚¬${zvw.toFixed(2)}<br>
    ğŸ§¾ <b>Total Tax:</b> â‚¬${totalTax.toFixed(2)}<br>
    âœ… <b>You Saved:</b> â‚¬${totalSaved.toFixed(2)}
  `;
}
</script>

</body>
</html>
