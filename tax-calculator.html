<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SmartWerk Tax Calculator v10</title>
  <style>
    body { font-family: sans-serif; padding: 2em; background: #f4f4f4; }
    h2 { color: #222; }
    .section { background: #fff; padding: 1em 2em; margin-bottom: 20px; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    label { display: block; margin: 10px 0 5px; }
    input, select { width: 100%; padding: 8px; margin-bottom: 10px; }
    .summary { background: #e0ffe0; padding: 1em; border-radius: 6px; }
    .button-group button { margin-right: 10px; }
    .tooltip { font-size: 0.85em; color: #555; }
  </style>
</head>
<body>

  <h2>SmartWerk Tax Calculator v10</h2>

  <div class="section">
    <h3>Step 1: Your Info</h3>
    <label>Company Name:</label>
    <input type="text" id="companyName" />

    <label>Email / Phone:</label>
    <input type="text" id="contactInfo" />

    <label>Period:</label>
    <select id="period">
      <option value="Q1">January ‚Äì March (Q1)</option>
      <option value="Q2">April ‚Äì June (Q2)</option>
      <option value="Q3">July ‚Äì September (Q3)</option>
      <option value="Q4">October ‚Äì December (Q4)</option>
    </select>

    <label>Hours Worked:</label>
    <input type="number" id="hoursWorked" oninput="autoCalcIncome()" />

    <label>Hourly Rate (EUR):</label>
    <input type="number" id="hourlyRate" oninput="autoCalcIncome()" />

    <label>Total Income (auto):</label>
    <input type="number" id="income" readonly />
  </div>

  <div class="section">
    <h3>Step 2: Expenses</h3>
    <label>Vehicle Expenses:</label><input type="number" id="vehicle" />
    <label>Office Expenses:</label><input type="number" id="office" />
    <label>Internet Expenses:</label><input type="number" id="internet" />
    <label>Marketing Expenses:</label><input type="number" id="marketing" />
    <label>Other Expenses:</label><input type="number" id="other" />
    <label>Extra Benefits (EUR):</label><input type="number" id="extraBenefits" />
  </div>

  <div class="section">
    <h3>Step 3: Tax Options</h3>
    <label>KvK Registered?</label>
    <select id="kvk">
      <option value="yes">Yes</option>
      <option value="no">No</option>
    </select>

    <label>Worked 1,225+ hours?</label>
    <select id="zzpHours">
      <option value="yes">Yes</option>
      <option value="no">No</option>
    </select>

    <label>BTW Rate:</label>
    <select id="btwRate">
      <option value="21">21%</option>
      <option value="9">9%</option>
      <option value="0">0%</option>
    </select>

    <label>Use KOR?</label>
    <select id="kor">
      <option value="no">No</option>
      <option value="yes">Yes</option>
    </select>
  </div>

  <div class="section summary">
    <h3>Step 4: Result</h3>
    <div id="result">Complete the form to see summary...</div>
  </div>

  <div class="button-group">
    <button onclick="calculateTax()">üîÑ Calculate Tax</button>
    <button onclick="exportPDF()">üìÑ Export as PDF</button>
    <button onclick="alert('Sending to accountant...')">üìß Send to Accountant</button>
    <button onclick="window.open('ai-assistant.html')">ü§ñ Ask SmartWerk AI</button>
  </div>

  <script>
    function autoCalcIncome() {
      const h = +document.getElementById("hoursWorked").value || 0;
      const r = +document.getElementById("hourlyRate").value || 0;
      document.getElementById("income").value = h * r;
    }

function calculate() {
  // 1. –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ
  const hours = +document.getElementById("hoursWorked").value || 0;
  const rate = +document.getElementById("hourlyRate").value || 0;
  const incomeInput = +document.getElementById("income").value || 0;
  const income = hours > 0 && rate > 0 ? hours * rate : incomeInput;

  const vehicle = +document.getElementById("vehicle").value || 0;
  const office = +document.getElementById("office").value || 0;
  const internet = +document.getElementById("internet").value || 0;
  const marketing = +document.getElementById("marketing").value || 0;
  const other = +document.getElementById("other").value || 0;
  const extraBenefits = +document.getElementById("extraBenefits").value || 0;

  const isKvK = document.getElementById("kvk").value === "yes";
  const is1225 = document.getElementById("zzpHours").value === "yes";
  const kor = document.getElementById("kor").value === "yes";

  const btwRate = +document.getElementById("btwRate").value || 0;

  // 2. –í–∏—Ç—Ä–∞—Ç–∏ —ñ –ø—Ä–∏–±—É—Ç–æ–∫
  const totalExpenses = vehicle + office + internet + marketing + other;
  const profit = income - totalExpenses + extraBenefits;

  // 3. –ü—ñ–ª—å–≥–∏
  let aftrek = 0;
  if (isKvK && is1225) {
    aftrek += 5030; // zelfstandigenaftrek
    aftrek += 2123; // startersaftrek
  }

  let taxableProfit = Math.max(0, profit - aftrek);
  const mkbVrijstelling = taxableProfit * 0.127;
  let afterMkb = taxableProfit - mkbVrijstelling;

  // 4. –û–±–º–µ–∂–µ–Ω–Ω—è –ø—ñ–ª—å–≥ (–º–∞–∫—Å 37.48% –∑–º–µ–Ω—à–µ–Ω–Ω—è)
  const capped = Math.min(afterMkb, taxableProfit * (1 - 0.3748));

  // 5. –ü—Ä–æ–≥—Ä–µ—Å–∏–≤–Ω–∞ —Å—Ç–∞–≤–∫–∞
  let incomeTax = 0;
  if (capped <= 200000) {
    incomeTax = capped * 0.19;
  } else {
    incomeTax = 200000 * 0.19 + (capped - 200000) * 0.258;
  }

  // 6. ZVW (5.32%) ‚Äî –∑ max –æ–±–º–µ–∂–µ–Ω–Ω—è–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, ‚Ç¨3.865)
  let zvw = profit * 0.0532;
  if (zvw > 3865) zvw = 3865;

  // 7. Total Tax
  let totalTax = incomeTax + zvw;

  // 8. KOR ‚Äî —Å–ø—Ä–æ—â–µ–Ω–∞ –º–æ–¥–µ–ª—å (–Ω–µ–º–∞—î VAT, —è–∫—â–æ —Ç–∞–∫)
  const korNote = kor ? "<br>‚ö†Ô∏è KOR selected ‚Äî simplified VAT scheme applied." : "";

  // 9. –í–∏–≤—ñ–¥
  document.getElementById("income").value = income.toFixed(2);
  document.getElementById("result").innerHTML =
    `üíº <b>Taxable profit:</b> ‚Ç¨${taxableProfit.toFixed(2)}<br>
    üîª <b>After mkb-winstvrijstelling (12.7%):</b> ‚Ç¨${afterMkb.toFixed(2)}<br>
    üßÆ <b>Income Tax:</b> ‚Ç¨${incomeTax.toFixed(2)}<br>
    üè• <b>ZVW (5.32%):</b> ‚Ç¨${zvw.toFixed(2)}<br>
    üí∞ <b>Total Estimated Tax:</b> ‚Ç¨${totalTax.toFixed(2)}<br>
    ‚úÖ <b>You saved:</b> ‚Ç¨${(aftrek + mkbVrijstelling).toFixed(2)}${korNote}`;
}

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –ø—Ä–∏ –∫–æ–∂–Ω—ñ–π –∑–º—ñ–Ω—ñ
document.querySelectorAll("input, select").forEach(el => {
  el.addEventListener("input", calculate);
  el.addEventListener("change", calculate);
});
</body>
</html>  }    function exportPDF() {
      alert("üìù PDF Export coming soon...");
    }
  </script>
</body>
</html>
