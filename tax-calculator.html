<!-- SmartWerk Tax Calculator v10.7 FINAL -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SmartWerk Tax Calculator</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 600px;
      margin: auto;
      padding: 20px;
    }
    h2 { margin-top: 30px; }
    label, input, select {
      display: block;
      width: 100%;
      margin-bottom: 12px;
    }
    .section {
      border: 1px solid #ddd;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 6px;
    }
    .summary {
      background-color: #f9f9f9;
      padding: 15px;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <h1>SmartWerk Tax Calculator</h1>

  <!-- Step 1 -->
  <div class="section">
    <h2>Step 1: Your Info</h2>
    <label>Company Name <input id="companyName" /></label>
    <label>Email / Phone <input id="contact" /></label>
    <label>Hours Worked <input id="hoursWorked" type="number" /></label>
    <label>Hourly Rate (€) <input id="hourlyRate" type="number" /></label>
    <label>KvK Registered?
      <select id="kvk"><option value="yes">Yes</option><option value="no">No</option></select>
    </label>
    <label>Worked 1,225+ hours?
      <select id="hours1225"><option value="yes">Yes</option><option value="no">No</option></select>
    </label>
  </div>

  <!-- Step 2 -->
  <div class="section">
    <h2>Step 2: Expenses</h2>
    <label>Auto Costs (€) <input id="autoCosts" type="number" /></label>
    <label>Office Costs (€) <input id="officeCosts" type="number" /></label>
    <label>Internet & Phone (€) <input id="internetCosts" type="number" /></label>
    <label>Marketing (€) <input id="marketingCosts" type="number" /></label>
    <label>Other Expenses (€) <input id="otherCosts" type="number" /></label>
    <label>Extra Benefits / Subsidies (€) <input id="benefits" type="number" /></label>
  </div>

  <!-- Step 3 -->
  <div class="section">
    <h2>Step 3: Tax Settings</h2>
    <label>BTW Rate
      <select id="btwRate">
        <option value="21">21%</option>
        <option value="9">9%</option>
        <option value="0">0%</option>
      </select>
    </label>
    <label>Use KOR?
      <select id="kor"><option value="no">No</option><option value="yes">Yes</option></select>
    </label>
  </div>

  <!-- Step 4 -->
  <div class="section summary">
    <h2>Step 4: Summary</h2>
    <div id="summary"></div>
  </div>

  <script>
    const fields = [
      "hoursWorked", "hourlyRate", "autoCosts", "officeCosts",
      "internetCosts", "marketingCosts", "otherCosts", "benefits",
      "btwRate", "kor", "kvk", "hours1225"
    ];
    fields.forEach(id => document.getElementById(id).addEventListener("input", calculate));

    function calculate() {
      const income = +hoursWorked.value * +hourlyRate.value;
      const expenses = +autoCosts.value + +officeCosts.value + +internetCosts.value +
                       +marketingCosts.value + +otherCosts.value;
      const benefits = +benefits.value || 0;
      const taxable = income - expenses + benefits;

      // BTW
      const btwRate = +btwRateSelect.value;
      const btwAmount = btwRate === 0 ? 0 : (taxable * btwRate / 100);

      // Startersaftrek
      let deduction = 0;
      if (kvk.value === "yes" && hours1225.value === "yes") deduction += 2123;
      deduction += taxable * 0.127; // MKB

      const taxableIncome = Math.max(0, taxable - deduction);

      // Income tax: 19% до €200k, 25.8% понад
      let incomeTax = 0;
      if (taxableIncome <= 200000) incomeTax = taxableIncome * 0.19;
      else incomeTax = 200000 * 0.19 + (taxableIncome - 200000) * 0.258;

      // ZVW
      const zvw = taxableIncome * 0.0532;

      // Final
      const totalTax = incomeTax + zvw;
      const net = taxable - totalTax;

      summary.innerHTML = `
        <p><strong>Gross Income:</strong> €${income.toFixed(2)}</p>
        <p><strong>Total Expenses:</strong> €${expenses.toFixed(2)}</p>
        <p><strong>Taxable Income:</strong> €${taxableIncome.toFixed(2)}</p>
        <p><strong>BTW (${btwRate}%):</strong> €${btwAmount.toFixed(2)}</p>
        <p><strong>Income Tax:</strong> €${incomeTax.toFixed(2)}</p>
        <p><strong>ZVW (5.32%):</strong> €${zvw.toFixed(2)}</p>
        <p><strong>Total Tax:</strong> €${totalTax.toFixed(2)}</p>
        <p><strong>Net Profit:</strong> €${net.toFixed(2)}</p>
        <p style="color:green"><strong>You saved €${deduction.toFixed(2)} in deductions!</strong></p>
      `;
    }

    window.onload = calculate;
  </script>
</body>
</html>
