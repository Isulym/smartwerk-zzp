<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>📃 Freelance Contract - SmartWerk</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style-contract.css" />
</head>
<body>
  <div class="wrap">
    <header class="topbar">
      <a class="brand" href="templates.html">📃 Freelance Contract (NL/EN)</a>
      <nav class="right">
        <a href="dashboard.html" class="btn">← Back to Dashboard</a>
      </nav>
    </header>

    <section class="intro">
      <h1>📃 Create Freelance Contract</h1>
      <p class="muted">Fill out the details below to generate a professional freelance contract. You can export it as PDF or DOCX, and use AI to help complete it.</p>
    </section>

    <form id="contractForm">
      <div class="form-section">
        <h2>🧾 Business Info</h2>
        <input type="text" id="businessName" placeholder="Your Business Name" required />
        <input type="text" id="businessKvK" placeholder="KvK Number (optional)" />
        <input type="text" id="businessVAT" placeholder="VAT Number (optional)" />
        <input type="text" id="businessIBAN" placeholder="IBAN (optional)" />
      </div>

      <div class="form-section">
        <h2>👤 Client Info</h2>
        <input type="text" id="clientName" placeholder="Client Name" required />
        <input type="text" id="clientAddress" placeholder="Client Address (optional)" />
      </div>

      <div class="form-section">
        <h2>📋 Project Details</h2>
        <textarea id="projectDescription" placeholder="Describe the project scope and deliverables..." required></textarea>
        <textarea id="timeline" placeholder="Timeline / Milestones (optional)"></textarea>
      </div>

      <div class="form-section">
        <h2>💶 Payment Terms</h2>
        <input type="text" id="rate" placeholder="Total Rate / Hourly Rate" />
        <textarea id="paymentTerms" placeholder="E.g. 50% upfront, 50% after delivery (optional)"></textarea>
      </div>

      <div class="form-section">
        <h2>⚖️ Legal</h2>
        <textarea id="terminationClause" placeholder="Termination terms, cancellation period, etc."></textarea>
        <textarea id="jurisdiction" placeholder="This contract is governed by the laws of the Netherlands."></textarea>
      </div>

      <div class="form-section">
        <h2>✍️ Signature</h2>
        <input type="text" id="signatureName" placeholder="Your Name" required />
        <input type="date" id="contractDate" required />
      </div>

      <div class="actions">
        <button type="button" class="btn ghost" id="aiFillBtn">🤖 AI Fill</button>
        <button type="submit" class="btn primary" id="downloadPDFBtn">Export as PDF</button>
        <button type="button" class="btn ghost" id="downloadDOCXBtn">Download DOCX</button>
      </div>
    </form>

    <footer class="foot-note">
      <p class="muted">Generated with SmartWerk — smartwerk.nl</p>
    </footer>
  </div>

   <script>

   // ✅ SmartWerk Freelance Contract — FULL JS FILE

import { saveAs } from "https://cdn.jsdelivr.net/npm/file-saver@2.0.5/+esm";
import { Document, Packer, Paragraph, TextRun, HeadingLevel } from "https://cdn.jsdelivr.net/npm/docx@7.7.0/+esm";

// PDF libraries
import jsPDF from "https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js";

// DOM Loaded
document.addEventListener("DOMContentLoaded", () => {
  const validUntil = new Date();
  validUntil.setDate(validUntil.getDate() + 14);
  const formattedDate = validUntil.toLocaleDateString();

  const contractForm = document.getElementById("contractForm");
  const aiFillBtn = document.getElementById("aiFillBtn");
  const downloadPDFBtn = document.getElementById("downloadPDFBtn");
  const downloadDOCXBtn = document.getElementById("downloadDOCXBtn");

  aiFillBtn.addEventListener("click", () => {
    document.getElementById("projectDescription").value = `Design and deliver a responsive website including homepage, services page, and contact form.`;
    document.getElementById("timeline").value = `Start: ${new Date().toLocaleDateString()}, Delivery: ${formattedDate}`;
    document.getElementById("rate").value = "€1500";
    document.getElementById("paymentTerms").value = "50% upfront, 50% after delivery";
    document.getElementById("terminationClause").value = "Either party may terminate this agreement with 7 days written notice.";
    document.getElementById("jurisdiction").value = "This contract is governed by the laws of the Netherlands.";
  });

  downloadPDFBtn.addEventListener("click", generateContractPDF);
  downloadDOCXBtn.addEventListener("click", exportContractAsDOCX);

  contractForm.addEventListener("submit", function (e) {
    e.preventDefault();
    saveContract();
    generateContractPDF();
  });
});

// 🔒 Save contract to localStorage
function saveContract() {
  const contract = getContractData();
  const saved = JSON.parse(localStorage.getItem("savedContracts") || "[]");
  saved.push(contract);
  localStorage.setItem("savedContracts", JSON.stringify(saved));
  alert("✅ Contract saved to localStorage!");
}

// 📄 Get all form data
function getContractData() {
  const get = (id) => document.getElementById(id)?.value || "-";
  return {
    businessName: get("businessName"),
    businessKvK: get("businessKvK"),
    businessVAT: get("businessVAT"),
    businessIBAN: get("businessIBAN"),
    clientName: get("clientName"),
    clientAddress: get("clientAddress"),
    projectDescription: get("projectDescription"),
    timeline: get("timeline"),
    rate: get("rate"),
    paymentTerms: get("paymentTerms"),
    terminationClause: get("terminationClause"),
    jurisdiction: get("jurisdiction"),
    signatureName: get("signatureName"),
    contractDate: get("contractDate") || new Date().toISOString().slice(0, 10),
  };
}

// 📄 Generate PDF
function generateContractPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const data = getContractData();
  let y = 20;

  function addSection(title, content) {
    doc.setFontSize(14);
    doc.setFont(undefined, "bold");
    doc.text(title, 14, y);
    y += 6;
    doc.setFontSize(12);
    doc.setFont(undefined, "normal");
    const splitText = doc.splitTextToSize(content, 180);
    doc.text(splitText, 14, y);
    y += splitText.length * 6 + 4;
  }

  doc.setFontSize(18);
  doc.text("📃 Freelance Contract", 14, y);
  y += 10;

  addSection("🧾 Business Info", `Name: ${data.businessName}\nKvK: ${data.businessKvK}\nVAT: ${data.businessVAT}\nIBAN: ${data.businessIBAN}`);
  addSection("👤 Client Info", `Name: ${data.clientName}\nAddress: ${data.clientAddress}`);
  addSection("📋 Project Description", data.projectDescription);
  addSection("📅 Timeline", data.timeline);
  addSection("💶 Payment Terms", `Rate: ${data.rate}\nTerms: ${data.paymentTerms}`);
  addSection("⚖️ Legal", `Termination: ${data.terminationClause}\nJurisdiction: ${data.jurisdiction}`);
  addSection("✍️ Signature", `Name: ${data.signatureName}\nDate: ${data.contractDate}`);

  doc.setFontSize(10);
  doc.setTextColor(150);
  doc.text("Generated with SmartWerk — smartwerk.nl", 14, 290);
  doc.save(`Contract-${data.clientName || "Client"}.pdf`);
}

// 📄 Generate DOCX
function exportContractAsDOCX() {
  const data = getContractData();
  const doc = new Document({
    sections: [
      {
        children: [
          new Paragraph({
            text: "📃 Freelance Contract",
            heading: HeadingLevel.TITLE,
          }),
          new Paragraph({
            text: `Generated by SmartWerk on ${data.contractDate}`,
            spacing: { after: 300 },
          }),
          ...section("🧾 Business Info", [
            `Name: ${data.businessName}`,
            `KvK: ${data.businessKvK}`,
            `VAT: ${data.businessVAT}`,
            `IBAN: ${data.businessIBAN}`,
          ]),
          ...section("👤 Client Info", [
            `Name: ${data.clientName}`,
            `Address: ${data.clientAddress}`,
          ]),
          ...section("📋 Project Details", [
            `Description: ${data.projectDescription}`,
            `Timeline: ${data.timeline}`,
          ]),
          ...section("💶 Payment Terms", [
            `Rate: ${data.rate}`,
            `Terms: ${data.paymentTerms}`,
          ]),
          ...section("⚖️ Legal", [
            `Termination Clause: ${data.terminationClause}`,
            `Jurisdiction: ${data.jurisdiction}`,
          ]),
          ...section("✍️ Signature", [
            `Signed by: ${data.signatureName}`,
            `Date: ${data.contractDate}`,
          ]),
          new Paragraph({
            text: "Generated with SmartWerk — smartwerk.nl",
            spacing: { before: 300 },
            style: "footer",
          }),
        ],
      },
    ],
  });

  Packer.toBlob(doc).then((blob) => {
    saveAs(blob, `SmartWerk-Contract-${data.clientName || "Client"}.docx`);
  });
}

function section(title, lines) {
  return [
    new Paragraph({
      text: title,
      heading: HeadingLevel.HEADING_2,
      spacing: { after: 100 },
    }),
    ...lines.map((line) =>
      new Paragraph({
        children: [new TextRun(line)],
        spacing: { after: 100 },
      })
    ),
  ];
}
     // saved-contracts.js — SmartWerk Freelance Contract | Saved Contracts

document.addEventListener("DOMContentLoaded", () => {
  const saveBtn = document.getElementById("saveBtn");
  const viewBtn = document.getElementById("viewSavedBtn");

  saveBtn?.addEventListener("click", () => {
    const contract = {
      businessName: get("businessName"),
      businessKvK: get("businessKvK"),
      businessVAT: get("businessVAT"),
      businessIBAN: get("businessIBAN"),
      clientName: get("clientName"),
      clientAddress: get("clientAddress"),
      projectDescription: get("projectDescription"),
      timeline: get("timeline"),
      rate: get("rate"),
      paymentTerms: get("paymentTerms"),
      terminationClause: get("terminationClause"),
      jurisdiction: get("jurisdiction"),
      signatureName: get("signatureName"),
      contractDate: get("contractDate"),
      id: Date.now()
    };

    const saved = JSON.parse(localStorage.getItem("smartwerkSavedContracts") || "[]");
    saved.push(contract);
    localStorage.setItem("smartwerkSavedContracts", JSON.stringify(saved));
    alert("✅ Contract saved successfully.");
  });

  viewBtn?.addEventListener("click", () => {
    const container = document.createElement("div");
    container.className = "saved-modal";
    container.innerHTML = `<div class="modal-content"><h2>📂 Saved Contracts</h2><div id="savedList"></div><button class="btn close-modal">Close</button></div>`;
    document.body.appendChild(container);

    const list = container.querySelector("#savedList");
    const saved = JSON.parse(localStorage.getItem("smartwerkSavedContracts") || "[]");

    if (!saved.length) {
      list.innerHTML = "<p class='muted'>No saved contracts found.</p>";
    } else {
      saved.forEach((c, i) => {
        const block = document.createElement("div");
        block.className = "saved-contract";
        block.innerHTML = `
          <strong>📄 ${c.clientName || "Unnamed Contract"}</strong><br/>
          <span class="muted">Date: ${c.contractDate}</span><br/>
          <button class="btn small export-pdf">Export PDF</button>
          <button class="btn small export-docx">Download DOCX</button>
          <button class="btn small danger delete-contract">🗑️</button>
        `;
        // PDF
        block.querySelector(".export-pdf").onclick = () => {
          fillFields(c);
          document.getElementById("downloadPDFBtn").click();
        };
        // DOCX
        block.querySelector(".export-docx").onclick = () => {
          fillFields(c);
          document.getElementById("downloadDOCXBtn").click();
        };
        // Delete
        block.querySelector(".delete-contract").onclick = () => {
          saved.splice(i, 1);
          localStorage.setItem("smartwerkSavedContracts", JSON.stringify(saved));
          container.remove();
          viewBtn.click();
        };
        list.appendChild(block);
      });
    }

    container.querySelector(".close-modal").onclick = () => container.remove();
  });

  function get(id) {
    return document.getElementById(id)?.value.trim() || "";
  }

  function fillFields(contract) {
    for (const key in contract) {
      const field = document.getElementById(key);
      if (field) field.value = contract[key];
    }
  }
});

     
     
   </script>

<script type="module" src="contract.js"></script>
<script type="module" src="contract-pdf.js"></script>
<script type="module" src="contract-docx.js"></script>
<script type="module" src="saved-contracts.js"></script>

  
</body>
</html>

