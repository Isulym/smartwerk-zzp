<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>📃 Freelance Contract - SmartWerk</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   <link rel="stylesheet" href="style-Freelance-Contract.css" />
</head>
<body>
  <header class="topbar">
      <nav class="left">
        <a href="dashboard.html" class="btn">← Back to Dashboard</a>
        <a href="templates.html" class="btn">← Back to Templates</a>
      </nav>
    </header>
    
  <h1>📃 Create Freelance Contract</h1>
  <p class="small-note">Fill in the contract details, generate PDF/DOCX, save locally or use AI to help you.</p>

  <div class="section">
    <h2>Business Info</h2>
    <input id="businessName" placeholder="Your Business Name" />
    <input id="businessKvK" placeholder="KvK Number (optional)" />
    <input id="businessVAT" placeholder="VAT Number (optional)" />
    <input id="businessIBAN" placeholder="IBAN (optional)" />
  </div>

  <div class="section">
    <h2>Client Info</h2>
    <input id="clientName" placeholder="Client Name" />
    <input id="clientAddress" placeholder="Client Address (optional)" />
  </div>

  <div class="section">
    <h2>Project</h2>
    <textarea id="projectDescription" placeholder="Describe the project scope..."></textarea>
    <textarea id="timeline" placeholder="Timeline / Milestones (optional)"></textarea>
  </div>

  <div class="section">
    <h2>Payment Terms</h2>
    <input id="rate" placeholder="Total Rate / Hourly Rate" />
    <textarea id="paymentTerms" placeholder="E.g. 50% upfront, 50% after delivery (optional)"></textarea>
  </div>

  <div class="section">
    <h2>Legal</h2>
    <textarea id="terminationClause" placeholder="Termination terms, cancellation period, etc."></textarea>
    <textarea id="jurisdiction" placeholder="This contract is governed by the laws of the Netherlands."></textarea>
  </div>

  <div class="section">
    <h2>Signature</h2>
    <input id="signatureName" placeholder="Your Name" />
    <input type="date" id="contractDate" />
  </div>

  <div class="btn-group">
    <button onclick="fillAI()">🤖 AI Fill</button>
    <button onclick="saveContract()">💾 Save</button>
    <button onclick="saveContractToLocalStorage()">📂 Saved Contracts</button>
    <button onclick="downloadPDF()">📄 Print</button>
    <button onclick="downloadDOCX()">Download DOCX</button>
  </div>


 <section class="form-section">
  <h2>📂 Saved Contracts</h2>
  <div id="savedContractsList" class="saved-list">
    <!-- Saved contracts will appear here -->
  </div>
</section>
  
  <script>
    function generateContractText() {
      const today = new Date().toLocaleDateString();
      return `
FREELANCE CONTRACT

Date: ${document.getElementById('contractDate').value || today}
Business: ${businessName.value}
KvK: ${businessKvK.value}
VAT: ${businessVAT.value}
IBAN: ${businessIBAN.value}

Client: ${clientName.value}
Address: ${clientAddress.value}

Project:
${projectDescription.value}

Timeline:
${timeline.value}

Payment Terms:
${rate.value}
${paymentTerms.value}

Legal:
${terminationClause.value}
${jurisdiction.value}

Signature: ${signatureName.value}
      `.trim();
    }

    function updatePreview() {
      document.getElementById('contractPreview').textContent = generateContractText();
    }

    const fields = document.querySelectorAll("input, textarea");
    fields.forEach(f => f.addEventListener("input", updatePreview));

    function fillAI() {
      document.getElementById('projectDescription').value = "Develop a responsive website for the client's online store.";
      document.getElementById('timeline').value = "Week 1: Wireframe, Week 2: Development, Week 3: Testing & Launch";
      document.getElementById('paymentTerms').value = "50% upfront, 50% after delivery";
      document.getElementById('terminationClause').value = "Either party may terminate with 7 days written notice.";
      document.getElementById('jurisdiction').value = "This contract is governed by the laws of the Netherlands.";
      updatePreview();
    }

    function saveContract() {
      const saved = JSON.parse(localStorage.getItem("contracts") || "[]");
      saved.push(generateContractText());
      localStorage.setItem("contracts", JSON.stringify(saved));
      alert("✅ Contract saved!");
    }


    function downloadPDF() {
      const text = generateContractText();
      const win = window.open('', '', 'width=800,height=600');
      win.document.write(`<pre>${text}</pre>`);
      win.document.close();
      win.print();
    }

    function downloadDOCX() {
      const text = generateContractText();
      const blob = new Blob([text], { type: "application/msword" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `SmartWerk-Freelance-Contract.doc`;
      link.click();
    }

    updatePreview();

    function saveContractToLocalStorage() {
  const data = {
    businessName: document.getElementById("businessName").value,
    clientName: document.getElementById("clientName").value,
    projectDescription: document.getElementById("projectDescription").value,
    timeline: document.getElementById("timeline").value,
    paymentTerms: document.getElementById("paymentTerms").value,
    legal: document.getElementById("legal").value,
    signature: document.getElementById("signature").value,
    signatureDate: document.getElementById("signatureDate").value,
    fullContract: document.getElementById("contractText").innerText,
    timestamp: new Date().toLocaleString()
  };

  let saved = JSON.parse(localStorage.getItem("savedContracts") || "[]");
  saved.push(data);
  localStorage.setItem("savedContracts", JSON.stringify(saved));
  loadSavedContracts();
}

function loadSavedContracts() {
  const container = document.getElementById("savedContractsList");
  if (!container) return;
  container.innerHTML = "";

  const saved = JSON.parse(localStorage.getItem("savedContracts") || "[]");
  if (saved.length === 0) {
    container.innerHTML = "<p class='muted'>No saved contracts found.</p>";
    return;
  }

  saved.forEach((c, index) => {
    const div = document.createElement("div");
    div.className = "saved-contract";
    div.innerHTML = `
      <p><strong>${c.clientName}</strong> — <em>${c.timestamp}</em></p>
      <p><code>${c.fullContract.slice(0, 200)}...</code></p>
      <button class="btn small" onclick="viewContract(${index})">👁 View</button>
      <button class="btn small danger" onclick="deleteContract(${index})">🗑️ Delete</button>
    `;
    container.appendChild(div);
  });
}

function viewContract(index) {
  const saved = JSON.parse(localStorage.getItem("savedContracts") || "[]");
  const c = saved[index];
  if (!c) return alert("Not found.");

  const text = `
👤 Client: ${c.clientName}
📄 Project: ${c.projectDescription}
🧾 Contract:
${c.fullContract}
  `;
  alert(text);
}

function deleteContract(index) {
  if (!confirm("Delete this contract?")) return;
  const saved = JSON.parse(localStorage.getItem("savedContracts") || "[]");
  saved.splice(index, 1);
  localStorage.setItem("savedContracts", JSON.stringify(saved));
  loadSavedContracts();
}
  </script>
</body>
</html>
