<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>📄 Freelance Contract — SmartWerk</title>
  <link rel="stylesheet" href="style-Freelance-Contract.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
  <header class="topbar">
    <a class="btn back" href="dashboard.html">← Back to Dashboard</a>
    <a class="btn back" href="templates.html">← Back to Templates</a>
  </header>

  <main class="container">
    <h1>📄 Freelance Contract</h1>
    <p class="muted">Use this template to generate a simple freelance agreement between you and your client.</p>


    <form id="contractForm">
      <div class="column left">
        <label>Business Info</label>
        <textarea id="businessInfo" rows="4"></textarea>

        <label>Client Info</label>
        <textarea id="clientInfo" rows="4"></textarea>

        <label>Project Description</label>
        <textarea id="projectDescription" rows="5"></textarea>
      </div>

      <div class="column right">
        <label>Payment Terms</label>
        <textarea id="paymentTerms" rows="4"></textarea>

        <label>Legal Clauses</label>
        <textarea id="legalClauses" rows="6"></textarea>

        <label>Signatures</label>
        <input type="text" id="businessSignature" placeholder="Business Signature" />
        <input type="text" id="clientSignature" placeholder="Client Signature" />
        <p>Date: <span id="signatureDate"></span></p>
      </div>
    </form>

     <div class="actions">
      <button class="btn" id="aiFill">🤖 AI Fill</button>
      <button class="btn" id="saveContract">💾 Save Contract</button>
      <button class="btn" id="viewContracts">📂 View Saved Contracts</button>
      <button class="btn" id="exportPDF">📄 Export PDF</button>
      <button class="btn" id="exportDOCX">📄 Export DOCX</button>
     </div>
    <section class="form-section" id="savedContracts">
      
  <h2>📂 Saved Contracts</h2>
  <table id="savedContracts">
    <thead>
      <tr>
        <th>Contract No</th>
        <th>Client</th>
        <th>Project</th>
        <th>Date</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="savedContractsBody">
      <!-- Filled by JavaScript -->
    </tbody>
  </table>
</section>


  <footer class="footer">
    <p class="muted">Generated with SmartWerk — smartwerk.nl</p>
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const date = new Date().toLocaleDateString();
      document.getElementById("signatureDate").textContent = date;

      document.getElementById("aiFill").addEventListener("click", () => {
        document.getElementById("businessInfo").value = "SmartWerk B.V.\nKvK: 12345678\nVAT: NL001234567B01\nEmail: info@smartwerk.nl";
        document.getElementById("clientInfo").value = "John Doe\nClient Company Ltd.\nEmail: john@example.com";
        document.getElementById("projectDescription").value = "Design and develop a responsive website with custom CMS.";
        document.getElementById("paymentTerms").value = "Total payment: €2000. 50% upfront, 50% upon delivery.";
        document.getElementById("legalClauses").value = "Both parties agree to the general terms. Disputes handled under Dutch law.";
        document.getElementById("businessSignature").value = "SmartWerk B.V.";
        document.getElementById("clientSignature").value = "John Doe";
      });

      document.getElementById("saveContract").addEventListener("click", () => {
        const contract = {
          businessInfo: document.getElementById("businessInfo").value,
          clientInfo: document.getElementById("clientInfo").value,
          projectDescription: document.getElementById("projectDescription").value,
          paymentTerms: document.getElementById("paymentTerms").value,
          legalClauses: document.getElementById("legalClauses").value,
          businessSignature: document.getElementById("businessSignature").value,
          clientSignature: document.getElementById("clientSignature").value,
          date: document.getElementById("signatureDate").textContent
        };
        const saved = JSON.parse(localStorage.getItem("contracts") || "[]");
        saved.push(contract);
        localStorage.setItem("contracts", JSON.stringify(saved));
        alert("✅ Contract saved!");
      });

      document.getElementById("viewContracts").addEventListener("click", () => {
        const list = document.getElementById("contractList");
        list.innerHTML = "";
        const saved = JSON.parse(localStorage.getItem("contracts") || "[]");
        saved.forEach((c, i) => {
          const li = document.createElement("li");
          li.textContent = `Contract with ${c.clientSignature} — ${c.date}`;
          li.addEventListener("click", () => {
            document.getElementById("businessInfo").value = c.businessInfo;
            document.getElementById("clientInfo").value = c.clientInfo;
            document.getElementById("projectDescription").value = c.projectDescription;
            document.getElementById("paymentTerms").value = c.paymentTerms;
            document.getElementById("legalClauses").value = c.legalClauses;
            document.getElementById("businessSignature").value = c.businessSignature;
            document.getElementById("clientSignature").value = c.clientSignature;
            document.getElementById("signatureDate").textContent = c.date;
          });
          list.appendChild(li);
        });
        document.getElementById("savedContracts").classList.remove("hidden");
      });

      document.getElementById("exportPDF").addEventListener("click", () => {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.setFontSize(12);
        doc.text("FREELANCE CONTRACT", 105, 15, { align: "center" });
        let y = 25;

        function section(title, text) {
          doc.setFont(undefined, "bold");
          doc.text(title, 15, y);
          y += 6;
          doc.setFont(undefined, "normal");
          const lines = doc.splitTextToSize(text, 180);
          doc.text(lines, 15, y);
          y += lines.length * 6 + 4;
        }

        section("Business Info", document.getElementById("businessInfo").value);
        section("Client Info", document.getElementById("clientInfo").value);
        section("Project Description", document.getElementById("projectDescription").value);
        section("Payment Terms", document.getElementById("paymentTerms").value);
        section("Legal Clauses", document.getElementById("legalClauses").value);

        doc.text("Signatures:", 15, y);
        y += 10;
        doc.text("Business:", 15, y);
        doc.text(document.getElementById("businessSignature").value, 50, y);
        y += 6;
        doc.text("Client:", 15, y);
        doc.text(document.getElementById("clientSignature").value, 50, y);
        y += 6;
        doc.text("Date:", 15, y);
        doc.text(document.getElementById("signatureDate").textContent, 50, y);

        doc.save("Freelance-Contract.pdf");
      });

      document.getElementById("exportDOCX").addEventListener("click", () => {
        const content = `Freelance Contract\n\nBusiness Info:\n${document.getElementById("businessInfo").value}\n\nClient Info:\n${document.getElementById("clientInfo").value}\n\nProject Description:\n${document.getElementById("projectDescription").value}\n\nPayment Terms:\n${document.getElementById("paymentTerms").value}\n\nLegal Clauses:\n${document.getElementById("legalClauses").value}\n\nSignatures:\nBusiness: ${document.getElementById("businessSignature").value}\nClient: ${document.getElementById("clientSignature").value}\nDate: ${document.getElementById("signatureDate").textContent}`;
        const blob = new Blob([content], { type: "application/msword" });
        saveAs(blob, "Freelance-Contract.docx");
      });
    });
function loadSavedContracts() {
  const saved = JSON.parse(localStorage.getItem("savedContracts") || "[]");
  const tbody = document.getElementById("savedContractsBody");
  if (!tbody) return;
  tbody.innerHTML = "";

  saved.forEach((contract, index) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${contract.contractNumber || "-"}</td>
      <td>${contract.clientName}</td>
      <td>${contract.projectTitle}</td>
      <td>${contract.date}</td>
      <td>
        <button class="btn small" onclick="viewContract(${index})">👁 View</button>
        <button class="btn small danger" onclick="deleteContract(${index})">🗑 Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}
    
    
function deleteContract(index) {
  if (!confirm("❌ Are you sure you want to delete this contract?")) return;
  const saved = JSON.parse(localStorage.getItem("savedContracts") || "[]");
  saved.splice(index, 1);
  localStorage.setItem("savedContracts", JSON.stringify(saved));
  loadSavedContracts(); // оновлення таблиці
}
    
  </script>
</body>
</html>
