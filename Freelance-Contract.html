<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>üìÉ Freelance Contract - SmartWerk</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style-Freelance-Contract.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <header class="topbar">
    <nav class="left">
      <a href="dashboard.html" class="btn">‚Üê Back to Dashboard</a>
      <a href="templates.html" class="btn">‚Üê Back to Templates</a>
    </nav>
  </header>

  <h1>üìÉ Create Freelance Contract</h1>
  <p class="small-note">Fill in the contract details, generate PDF/DOCX, save locally or use AI to help you.</p>

  <div class="section">
    <h2>Business Info</h2>
    <input id="businessName" placeholder="Your Business Name" />
    <input id="businessKvK" placeholder="KvK Number (optional)" />
    <input id="businessVAT" placeholder="VAT Number (optional)" />
    <input id="businessIBAN" placeholder="IBAN (optional)" />
  </div>

  <div class="section">
    <h2>Client Info</h2>
    <input id="clientName" placeholder="Client Name" />
    <input id="clientAddress" placeholder="Client Address (optional)" />
  </div>

  <div class="section">
    <h2>Project</h2>
    <textarea id="projectDescription" placeholder="Describe the project scope..."></textarea>
    <textarea id="timeline" placeholder="Timeline / Milestones (optional)"></textarea>
  </div>

  <div class="section">
    <h2>Payment Terms</h2>
    <input id="rate" placeholder="Total Rate / Hourly Rate" />
    <textarea id="paymentTerms" placeholder="E.g. 50% upfront, 50% after delivery (optional)"></textarea>
  </div>

  <div class="section">
    <h2>Legal</h2>
    <textarea id="terminationClause" placeholder="Termination terms, cancellation period, etc."></textarea>
    <textarea id="jurisdiction" placeholder="This contract is governed by the laws of the Netherlands."></textarea>
  </div>

  <div class="section">
    <h2>Signature</h2>
    <input id="signatureName" placeholder="Your Name" />
    <input type="date" id="contractDate" />
  </div>

  <div class="btn-group">
    <button onclick="fillAI()">‚ö° AI Fill</button>
    <button onclick="saveContract()">üíæ Save Contract</button>
    <button onclick="viewSavedContracts()">üìÇ View Saved Contracts</button>
    <button id="exportPdfBtn">üìÑ Export PDF</button>
    <button onclick="downloadDOCX()">Download DOCX</button>
  </div>

  <div class="section">
    <h2>Preview</h2>
    <div id="contractPreview" style="white-space: pre-line;">Contract will appear here...</div>
  </div>

  <div class="section" id="savedContractsSection" style="display:none">
    <h2>Saved Contracts</h2>
    <table>
      <thead>
        <tr>
          <th>Client</th>
          <th>Project</th>
          <th>Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="savedContractsBody"></tbody>
    </table>
  </div>

  <script>
    function generateContractText() {
      const today = new Date().toLocaleDateString();
      return `
FREELANCE CONTRACT

Date: ${document.getElementById('contractDate').value || today}
Business: ${businessName.value}
KvK: ${businessKvK.value}
VAT: ${businessVAT.value}
IBAN: ${businessIBAN.value}

Client: ${clientName.value}
Address: ${clientAddress.value}

Project:
${projectDescription.value}

Timeline:
${timeline.value}

Payment Terms:
${rate.value}
${paymentTerms.value}

Legal:
${terminationClause.value}
${jurisdiction.value}

Signature: ${signatureName.value}
      `.trim();
    }

    function updatePreview() {
      document.getElementById('contractPreview').textContent = generateContractText();
    }

    document.querySelectorAll("input, textarea").forEach(f => f.addEventListener("input", updatePreview));
    updatePreview();

    function fillAI() {
      businessName.value = "SmartWerk Freelance";
      businessKvK.value = "12345678";
      businessVAT.value = "NL000099998B57";
      businessIBAN.value = "NL99BANK0123456789";
      clientName.value = "Client Company B.V.";
      clientAddress.value = "Keizersgracht 123, 1015CJ Amsterdam";
      projectDescription.value = "Develop a multilingual responsive website for online services.";
      timeline.value = "Week 1: UI/UX. Week 2: Dev. Week 3: Testing.";
      rate.value = "‚Ç¨3500 fixed";
      paymentTerms.value = "50% upfront, 50% upon delivery";
      terminationClause.value = "Termination with 7 days notice from either side.";
      jurisdiction.value = "This contract is governed by the laws of the Netherlands.";
      signatureName.value = "John Freelancer";
      contractDate.value = new Date().toISOString().split('T')[0];
      updatePreview();
    }

    function saveContract() {
      const saved = JSON.parse(localStorage.getItem("contracts") || "[]");
      saved.push({
        client: clientName.value,
        project: projectDescription.value.slice(0, 50),
        date: contractDate.value || new Date().toLocaleDateString(),
        text: generateContractText()
      });
      localStorage.setItem("contracts", JSON.stringify(saved));
      alert("‚úÖ Contract saved!");
    }

    function viewSavedContracts() {
      const saved = JSON.parse(localStorage.getItem("contracts") || "[]");
      const section = document.getElementById("savedContractsSection");
      const tbody = document.getElementById("savedContractsBody");
      section.style.display = "block";
      tbody.innerHTML = "";
      saved.forEach((c, i) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${c.client}</td>
          <td>${c.project}</td>
          <td>${c.date}</td>
          <td>
            <button onclick="loadContract(${i})">üëÅ View</button>
            <button onclick="deleteContract(${i})">üóë Delete</button>
          </td>
        `;
        tbody.appendChild(row);
      });
    }

    function loadContract(index) {
      const saved = JSON.parse(localStorage.getItem("contracts") || "[]");
      const c = saved[index];
      if (!c) return;
      alert("Loaded contract:\n\n" + c.text);
    }

    function deleteContract(index) {
      const saved = JSON.parse(localStorage.getItem("contracts") || "[]");
      saved.splice(index, 1);
      localStorage.setItem("contracts", JSON.stringify(saved));
      viewSavedContracts();
    }

   function exportPdfBtn() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  // –î–∞–Ω—ñ –∑ —Ñ–æ—Ä–º–∏
  const today = new Date().toISOString().split('T')[0];
  const businessName = document.getElementById("businessName").value;
  const kvk = document.getElementById("kvk").value;
  const vat = document.getElementById("vat").value;
  const iban = document.getElementById("iban").value;

  const clientName = document.getElementById("clientName").value;
  const clientAddress = document.getElementById("clientAddress").value;

  const project = document.getElementById("project").value;
  const timeline = document.getElementById("timeline").value;
  const payment = document.getElementById("payment").value;
  const legal = document.getElementById("legal").value;

  const signature = document.getElementById("signatureName").value;
  const signDate = document.getElementById("signatureDate").value;

  let y = 20;

  // –ó–∞–≥–æ–ª–æ–≤–æ–∫
  doc.setFontSize(16);
  doc.text("FREELANCE CONTRACT", 105, y, { align: "center" });
  y += 10;

  doc.setFontSize(10);
  doc.text(`Date: ${today}`, 14, y);
  y += 8;

  // Business & Client Info (–¥–≤—ñ –∫–æ–ª–æ–Ω–∫–∏)
  doc.setFont(undefined, "bold");
  doc.text("Business Info", 14, y);
  doc.text("Client Info", 110, y);
  doc.setFont(undefined, "normal");
  y += 6;
  doc.text(`${businessName}`, 14, y);
  doc.text(`${clientName}`, 110, y);
  y += 5;
  doc.text(`KvK: ${kvk}`, 14, y);
  doc.text(`Address: ${clientAddress}`, 110, y);
  y += 5;
  doc.text(`VAT: ${vat}`, 14, y);
  y += 5;
  doc.text(`IBAN: ${iban}`, 14, y);
  y += 10;

  // –ü—Ä–æ—î–∫—Ç
  doc.setFont(undefined, "bold");
  doc.text("Project", 14, y);
  doc.setFont(undefined, "normal");
  y += 6;
  const splitProject = doc.splitTextToSize(project, 180);
  doc.text(splitProject, 14, y);
  y += splitProject.length * 6;

  // –¢–∞–π–º–ª–∞–π–Ω
  doc.setFont(undefined, "bold");
  doc.text("Timeline", 14, y);
  doc.setFont(undefined, "normal");
  y += 6;
  const splitTimeline = doc.splitTextToSize(timeline, 180);
  doc.text(splitTimeline, 14, y);
  y += splitTimeline.length * 6;

  // –û–ø–ª–∞—Ç–∞
  doc.setFont(undefined, "bold");
  doc.text("Payment Terms", 14, y);
  doc.setFont(undefined, "normal");
  y += 6;
  const splitPayment = doc.splitTextToSize(payment, 180);
  doc.text(splitPayment, 14, y);
  y += splitPayment.length * 6;

  // Legal
  doc.setFont(undefined, "bold");
  doc.text("Legal", 14, y);
  doc.setFont(undefined, "normal");
  y += 6;
  const splitLegal = doc.splitTextToSize(legal, 180);
  doc.text(splitLegal, 14, y);
  y += splitLegal.length * 6;

  // –ü—ñ–¥–ø–∏—Å
  y += 10;
  doc.setFont(undefined, "bold");
  doc.text("Signature:", 14, y);
  doc.setFont(undefined, "normal");
  doc.text(signature, 40, y);
  y += 6;
  doc.text(`Date: ${signDate}`, 14, y);

  // Footer / watermark
  doc.setFontSize(8);
  doc.setTextColor(150);
  doc.text("Generated with SmartWerk Freelance Contract Tool", 105, 290, { align: "center" });

  doc.save("Freelance-Contract.pdf");
}
    function downloadDOCX() {
      const text = generateContractText();
      const blob = new Blob([text], { type: "application/msword" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `SmartWerk-Freelance-Contract.doc`;
      link.click();
    }
  </script>
</body>
</html>
