<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“§ Email to Gemeente â€“ SmartWerk</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style-email.css" />
</head>
<body>
  <div class="wrap">
    <header class="topbar">
      <a class="brand" href="templates.html">ğŸ“§ Email to Gemeente</a>
      <nav class="right">
        <a href="dashboard.html" class="btn">â† Back to Dashboard</a>
      </nav>
    </header>

    <section class="intro">
      <h1>ğŸ“§ Write Email to Gemeente</h1>
      <p class="muted">Use this tool to send a structured request, complaint, or information email to your municipality.</p>
    </section>

    <form id="emailForm">
      <div class="form-section">
        <h2>ğŸ§¾ From (Your Info)</h2>
        <input type="text" id="userName" placeholder="Your Full Name" required />
        <input type="email" id="userEmail" placeholder="Your Email" required />
        <input type="text" id="userAddress" placeholder="Your Address (optional)" />
      </div>

      <div class="form-section">
        <h2>ğŸ›ï¸ To (Gemeente Info)</h2>
        <input type="text" id="gemeenteName" placeholder="Gemeente Name (e.g., Den Bosch)" required />
        <input type="email" id="gemeenteEmail" placeholder="Gemeente Email (optional)" />
      </div>

      <div class="form-section">
        <h2>ğŸ“ Email Content</h2>
        <input type="text" id="subject" placeholder="Subject (e.g., Request for housing)" required />
        <textarea id="emailBody" rows="10" placeholder="Describe your request, complaint, or message to the gemeente..." required></textarea>
        <input type="text" id="city" placeholder="City (e.g., Den Bosch)" />
        <input type="date" id="emailDate" />
      </div>

      <div class="form-section actions">
        <button type="button" class="btn ghost" id="aiFillBtn">ğŸ¤– AI Fill</button>
        <button type="button" class="btn ghost" id="loadExampleBtn">ğŸ“‚ Load Example</button>
        <button type="button" class="btn ghost" id="translateBtn">ğŸŒ Translate</button>
        <button type="button" class="btn ghost" id="saveBtn">ğŸ’¾ Save</button>
        <button type="button" class="btn ghost" id="viewSavedBtn">ğŸ“‚ Saved Emails</button>
        <button type="button" class="btn ghost" id="printBtn">ğŸ–¨ï¸ Print</button>
        <button type="button" class="btn ghost" id="sendEmailBtn">ğŸ“¤ Send via Email</button>
        <button type="submit" class="btn primary" id="exportBtn">ğŸ“„ Export as PDF</button>
        <button type="button" class="btn" id="exportPDFBtn">ğŸ“„ Export as PDF</button>
      </div>
    </form>

    <footer class="foot-note">
      <p class="muted">Created with â¤ï¸ by SmartWerk â€“ smartwerk.nl</p>
    </footer>
  </div>

  <!-- Modal for saved emails -->
  <div id="savedEmailsModal" class="modal hidden">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <h2>ğŸ“‚ Saved Emails</h2>
      <ul id="savedEmailsList"></ul>
    </div>
  </div>

  <!-- JS Scripts -->
  <script>

document.addEventListener("DOMContentLoaded", () => {
  const form = document.getElementById("emailForm");
  const subjectEl = document.getElementById("subject");
  const bodyEl = document.getElementById("body");
  const cityEl = document.getElementById("city");
  const todayEl = document.getElementById("todayDate");
  const output = document.getElementById("output");
  const aiBtn = document.getElementById("aiFillBtn");
  const printBtn = document.getElementById("printBtn");
  const exampleBtn = document.getElementById("exampleBtn");
  const langSelector = document.getElementById("language");

  // ğŸ—“ï¸ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğ° Ğ´Ğ°Ñ‚Ğ°
  const today = new Date().toISOString().slice(0, 10);
  todayEl.value = today;

  // ğŸ§  AI-Ğ·Ğ°Ğ¿Ğ¾Ğ²Ğ½ĞµĞ½Ğ½Ñ (Ğ´ĞµĞ¼Ğ¾-Ğ»Ğ¾Ğ³Ñ–ĞºĞ°)
  aiBtn.addEventListener("click", () => {
    subjectEl.value = "Request for urgent housing support";
    bodyEl.value = `Dear Gemeente,

I am writing to request urgent assistance regarding housing. My current living situation is unsustainable, and I kindly ask for your help in finding a suitable solution.

Sincerely,
[Your Name]`;

    subjectEl.classList.add("ai-filled");
    bodyEl.classList.add("ai-filled");
  });

  // ğŸ§ª Load Example
  exampleBtn.addEventListener("click", () => {
    subjectEl.value = "Complaint about housing conditions";
    bodyEl.value = `Dear Gemeente,

I would like to file a complaint regarding my current accommodation. The conditions are below acceptable standards, and I respectfully request your immediate attention to this matter.

Kind regards,
[Your Name]`;

    subjectEl.classList.add("ai-filled");
    bodyEl.classList.add("ai-filled");
  });

  // ğŸ’¾ ĞĞ²Ñ‚Ğ¾Ğ·Ğ±ĞµÑ€ĞµĞ¶ĞµĞ½Ğ½Ñ
  form.addEventListener("input", () => {
    const data = {
      name: document.getElementById("name").value,
      email: document.getElementById("email").value,
      city: cityEl.value,
      date: todayEl.value,
      subject: subjectEl.value,
      body: bodyEl.value,
    };
    localStorage.setItem("smartEmailToGemeente", JSON.stringify(data));
  });

  // ğŸ“¥ ĞĞ²Ñ‚Ğ¾Ğ²Ñ–Ğ´Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ
  const saved = JSON.parse(localStorage.getItem("smartEmailToGemeente"));
  if (saved) {
    document.getElementById("name").value = saved.name || "";
    document.getElementById("email").value = saved.email || "";
    cityEl.value = saved.city || "";
    todayEl.value = saved.date || today;
    subjectEl.value = saved.subject || "";
    bodyEl.value = saved.body || "";
  }

  // ğŸŒ Multi-language placeholders
  langSelector.addEventListener("change", () => {
    const lang = langSelector.value;
    if (lang === "nl") {
      subjectEl.placeholder = "Onderwerp van de e-mail";
      bodyEl.placeholder = "Typ hier uw bericht in het Nederlands...";
    } else {
      subjectEl.placeholder = "Subject of the email";
      bodyEl.placeholder = "Type your message here in English...";
    }
  });

  // ğŸ–¨ï¸ Ğ”Ñ€ÑƒĞº
  printBtn.addEventListener("click", () => window.print());

  // ğŸ“§ Send via Email (PRO)
  document.getElementById("sendEmailBtn")?.addEventListener("click", () => {
    const mailtoLink = `mailto:${document.getElementById("email").value}?subject=${encodeURIComponent(subjectEl.value)}&body=${encodeURIComponent(bodyEl.value)}`;
    window.open(mailtoLink, "_blank");
  });
});

   type="module">
  import jsPDF from "https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js";

  const exportEmailAsPDF = async () => {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    const get = (id) => document.getElementById(id)?.value?.trim() || "-";

    let y = 20;
    doc.setFontSize(18);
    doc.text("ğŸ“§ Email to Gemeente", 14, y);
    y += 10;

    doc.setFontSize(12);
    doc.text("From:", 14, y);
    y += 6;
    doc.text(`Name: ${get("senderName")}`, 14, y); y += 6;
    doc.text(`Email: ${get("senderEmail")}`, 14, y); y += 6;
    doc.text(`Address: ${get("senderAddress")}`, 14, y); y += 10;

    doc.text("To:", 14, y);
    y += 6;
    doc.text(`${get("receiverName")}`, 14, y); y += 10;

    doc.text("Subject:", 14, y);
    y += 6;
    const subjectLines = doc.splitTextToSize(get("subject"), 180);
    doc.text(subjectLines, 14, y);
    y += subjectLines.length * 6 + 4;

    doc.text("Date:", 14, y);
    y += 6;
    doc.text(`${get("todayDate")}`, 14, y);
    y += 10;

    doc.text("Body:", 14, y);
    y += 6;
    const bodyLines = doc.splitTextToSize(get("body"), 180);
    doc.text(bodyLines, 14, y);
    y += bodyLines.length * 6 + 12;

    doc.setFontSize(10);
    doc.setTextColor(150);
    doc.text("Generated with SmartWerk â€” smartwerk.nl", 14, 290);

    doc.save(`Email-${get("receiverName") || "Gemeente"}.pdf`);
  };

  document.getElementById("exportPDFBtn")?.addEventListener("click", exportEmailAsPDF);

    
  </script>
</body>
</html>
