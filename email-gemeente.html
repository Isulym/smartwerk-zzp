<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ“§ Email to Gemeente â€” SmartWerk</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style-email.css" />
</head>
<body>
  <div class="wrap">
    <header class="topbar">
      <a class="brand" href="templates.html">ğŸ“§ Email to Gemeente</a>
      <nav class="right">
        <a href="dashboard.html" class="btn">â† Back to Dashboard</a>
      </nav>
    </header>

    <section class="intro">
      <h1>ğŸ“§ Write Email to Gemeente</h1>
      <p class="muted">Use this form to write professional emails to your local Dutch municipality (Gemeente). You can generate content with AI, translate, and export to PDF.</p>
    </section>

    <form id="emailForm">
      <div class="form-section">
        <h2>ğŸ§¾ From</h2>
        <input type="text" id="fromName" placeholder="Your Name" required />
        <input type="email" id="fromEmail" placeholder="Your Email Address" required />
        <input type="text" id="city" placeholder="City (for auto-signature)" />
        <input type="text" id="todayDate" disabled />
      </div>

      <div class="form-section">
        <h2>ğŸ“¨ To Gemeente</h2>
        <input type="email" id="toEmail" placeholder="Gemeente Email Address" required />
      </div>

      <div class="form-section">
        <h2>ğŸ“ Email Content</h2>
        <input type="text" id="subject" placeholder="Subject (e.g. Request for Housing)" required />
        <textarea id="emailBody" rows="10" placeholder="Type your email body or use AI to generate it..."></textarea>
      </div>

      <div class="form-section">
        <h2>ğŸ“‚ Example Templates</h2>
        <select id="templateSelector">
          <option value="">Choose example...</option>
          <option value="complaint">ğŸ“¢ Complaint</option>
          <option value="housing">ğŸ  Housing Request</option>
          <option value="subsidy">ğŸ’¶ Subsidy Inquiry</option>
          <option value="document">ğŸ“„ Request Documents</option>
        </select>
      </div>

      <div class="actions">
        <button type="button" class="btn ghost" id="aiFillBtn">ğŸ¤– AI Fill</button>
        <button type="button" class="btn" id="loadExampleBtn">ğŸ“‚ Load Example</button>
        <button type="button" class="btn ghost" id="translateBtn">ğŸŒ Translate</button>
        <button type="button" class="btn" id="saveBtn">ğŸ’¾ Save</button>
        <button type="button" class="btn" id="viewSavedBtn">ğŸ“‚ Saved Emails</button>
        <button type="button" class="btn ghost" id="printBtn">ğŸ–¨ï¸ Print</button>
        <button type="button" class="btn primary" id="sendBtn">ğŸ“¤ Send via Email</button>
        <button type="button" class="btn" id="exportPdfBtn">ğŸ“„ Export as PDF</button>
      </div>
    </form>

    <footer class="foot-note">
      <p class="muted">Generated with SmartWerk â€” smartwerk.nl</p>
    </footer>
  </div>

  <script type="module" src="email-gemeente.js"></script>
</body>
</html>
  <script>

document.addEventListener("DOMContentLoaded", () => {
  const get = (id) => document.getElementById(id);
  
  // Fill with AI example
  get("aiFillBtn")?.addEventListener("click", () => {
    get("senderName").value = "John Example";
    get("senderEmail").value = "john@example.com";
    get("senderAddress").value = "Main Street 1, 1234AB";
    get("receiverName").value = "Gemeente Den Bosch";
    get("subject").value = "Request for urgent housing support";
    get("body").value = `Dear Gemeente,\n\nI am writing to request urgent assistance with my current housing situation. My family and I are experiencing difficulties and would greatly appreciate any available support or programs.\n\nSincerely,\nJohn Example`;
    get("todayDate").value = new Date().toLocaleDateString();
    
    get("body").classList.add("ai-filled");
  });

  // Load Example
  get("loadExampleBtn")?.addEventListener("click", () => {
    get("subject").value = "Complaint regarding public service";
    get("body").value = "Dear Gemeente,\n\nI would like to file a complaint regarding...\n\nRegards,";
    get("body").classList.add("ai-filled");
  });

  // Translate placeholder (mock)
  get("translateBtn")?.addEventListener("click", () => {
    alert("ğŸŒ Auto-translation coming soon!");
  });

  // Auto-date
  const dateField = get("todayDate");
  if (dateField && !dateField.value) {
    dateField.value = new Date().toLocaleDateString();
  }

  // Save
  get("saveEmailBtn")?.addEventListener("click", () => {
    const email = {
      senderName: get("senderName").value,
      senderEmail: get("senderEmail").value,
      senderAddress: get("senderAddress").value,
      receiverName: get("receiverName").value,
      subject: get("subject").value,
      body: get("body").value,
      todayDate: get("todayDate").value,
    };
    const emails = JSON.parse(localStorage.getItem("savedEmails") || "[]");
    emails.push(email);
    localStorage.setItem("savedEmails", JSON.stringify(emails));
    alert("ğŸ’¾ Email saved!");
  });

  // Load saved emails
  get("savedEmailsBtn")?.addEventListener("click", () => {
    const emails = JSON.parse(localStorage.getItem("savedEmails") || "[]");
    if (emails.length === 0) return alert("ğŸ“‚ No saved emails found.");

    const last = emails[emails.length - 1];
    get("senderName").value = last.senderName;
    get("senderEmail").value = last.senderEmail;
    get("senderAddress").value = last.senderAddress;
    get("receiverName").value = last.receiverName;
    get("subject").value = last.subject;
    get("body").value = last.body;
    get("todayDate").value = last.todayDate;

    alert("âœ… Loaded latest saved email.");
  });

  // Print
  get("printBtn")?.addEventListener("click", () => {
    window.print();
  });

  // PDF
  get("exportPDFBtn")?.addEventListener("click", () => {
    alert("ğŸ“„ PDF Export coming next step...");
  });

  // Send via Email
  get("sendEmailBtn")?.addEventListener("click", () => {
    const email = get("senderEmail").value;
    const subject = get("subject").value;
    const body = get("body").value;
    window.location.href = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
  });
});

   type="module">
  import jsPDF from "https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js";

  const exportEmailAsPDF = async () => {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    const get = (id) => document.getElementById(id)?.value?.trim() || "-";

    let y = 20;
    doc.setFontSize(18);
    doc.text("ğŸ“§ Email to Gemeente", 14, y);
    y += 10;

    doc.setFontSize(12);
    doc.text("From:", 14, y);
    y += 6;
    doc.text(`Name: ${get("senderName")}`, 14, y); y += 6;
    doc.text(`Email: ${get("senderEmail")}`, 14, y); y += 6;
    doc.text(`Address: ${get("senderAddress")}`, 14, y); y += 10;

    doc.text("To:", 14, y);
    y += 6;
    doc.text(`${get("receiverName")}`, 14, y); y += 10;

    doc.text("Subject:", 14, y);
    y += 6;
    const subjectLines = doc.splitTextToSize(get("subject"), 180);
    doc.text(subjectLines, 14, y);
    y += subjectLines.length * 6 + 4;

    doc.text("Date:", 14, y);
    y += 6;
    doc.text(`${get("todayDate")}`, 14, y);
    y += 10;

    doc.text("Body:", 14, y);
    y += 6;
    const bodyLines = doc.splitTextToSize(get("body"), 180);
    doc.text(bodyLines, 14, y);
    y += bodyLines.length * 6 + 12;

    doc.setFontSize(10);
    doc.setTextColor(150);
    doc.text("Generated with SmartWerk â€” smartwerk.nl", 14, 290);

    doc.save(`Email-${get("receiverName") || "Gemeente"}.pdf`);
  };

  document.getElementById("exportPDFBtn")?.addEventListener("click", exportEmailAsPDF);

    
  </script>
</body>
</html>
