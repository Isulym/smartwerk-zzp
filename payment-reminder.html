<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Payment Reminder — SmartWerk</title>
  <link rel="stylesheet" href="style-reminder.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <h1>📈 Payment Reminder</h1>
    <p>Send professional reminders for unpaid invoices. Use AI assistance, export to PDF, or send by email.</p>

    <section>
      <h2>💼 Business Info (From)</h2>
      <input id="fromName" placeholder="Business Name" />
      <input id="fromEmail" placeholder="Business Email" />
      <input id="fromIBAN" placeholder="IBAN" />
      <input id="fromAddress" placeholder="Business Address" />
    </section>

    <section>
      <h2>👨‍💼 Client Info (To)</h2>
      <input id="clientName" placeholder="Client Name" />
      <input id="clientEmail" placeholder="Client Email" />
      <input id="clientAddress" placeholder="Client Address" />
    </section>

    <section>
      <h2>📄 Invoice Details</h2>
      <input id="reminderId" placeholder="Reminder ID (e.g., REM-2025-001)" readonly />
      <input id="invoiceNumber" placeholder="Invoice Number (e.g., INV-2025-001)" />
      <input id="invoiceDate" type="date" placeholder="Invoice Date" />
      <input id="dueDate" type="date" placeholder="Due Date" />
      <input id="amount" placeholder="Amount Due (e.g., 500)" />
      <p id="overdueMessage" class="muted"></p>
    </section>

    <section>
      <h2>📣 Reminder Type</h2>
      <select id="reminderType">
        <option value="First Reminder">First Reminder</option>
        <option value="Second Notice">Second Notice</option>
        <option value="Final Reminder">Final Reminder</option>
      </select>
    </section>

    <section>
      <h2>💬 Message Body</h2>
      <textarea id="messageBody" rows="6" placeholder="Message..."></textarea>
      <div class="row">
        <button id="btn-strict">💬 Make it more strict</button>
        <button id="btn-friendly">👍 Make it more friendly</button>
      </div>
    </section>

    <section>
      <h2>🗓 Date & Location</h2>
      <input id="city" placeholder="City" />
      <input id="reminderDate" type="date" placeholder="Reminder Date" />
    </section>

    <section>
      <h2>✍️ Signature</h2>
      <input id="signatureName" placeholder="Your Name" />
      <input id="signaturePosition" placeholder="Position (optional)" />
      <input id="signatureEmail" placeholder="Your Email" />
    </section>

    <section>
      <h2>💳 Payment</h2>
      <input id="paymentLink" placeholder="Payment Link (PayPal, Mollie, etc.)" />
      <a id="btn-pay" class="btn-green" target="_blank">Pay Now</a>
    </section>

    <section>
      <h2>📧 Attach Original Invoice</h2>
      <input type="file" id="attachedFile" />
    </section>

    <div class="buttons">
      <button id="aiFillBtn">🤖 AI Fill</button>
      <button id="loadExampleBtn">Load Example</button>
      <button id="translateBtn">Translate</button>
      <button id="btn-save">📃 Save</button>
      <button id="btn-view-saved">📂 Saved Reminders</button>
      <button id="btn-preview">📅 Preview</button>
      <button id="btn-send-email">Send via Email</button>
      <button id="btn-export-pdf">📄 Export as PDF</button>
      <button id="btn-print">🖨 Print</button>
    </div>

    <div id="savedRemindersModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="document.getElementById('savedRemindersModal').style.display='none'">&times;</span>
        <h3>📂 Saved Reminders</h3>
        <div id="savedRemindersList"></div>
      </div>
    </div>

  </div>

  <script>

document.addEventListener("DOMContentLoaded", () => {
  const get = (id) => document.getElementById(id)?.value || "";

  // Auto today's date
  const dateField = document.getElementById("reminderDate");
  if (dateField) dateField.value = new Date().toISOString().slice(0, 10);

  // Auto Reminder ID
  const idField = document.getElementById("reminderId");
  if (idField && !idField.value) {
    const number = String(Math.floor(Math.random() * 900) + 100);
    idField.value = `REM-2025-${number}`;
  }

  // AI Fill
  document.getElementById("aiFillBtn")?.addEventListener("click", () => {
    const name = get("clientName") || "John Doe";
    const amount = get("amount") || "€150";
    const dueDate = get("dueDate") || "2025-09-20";

    document.getElementById("clientName").value = name;
    document.getElementById("clientEmail").value = "john.doe@example.com";
    document.getElementById("subject").value = `Payment Reminder: ${amount} due`;
    document.getElementById("messageBody").value =
      `Dear ${name},\n\nThis is a friendly reminder that an outstanding amount of ${amount} is due on ${dueDate}.\n\nPlease make the payment at your earliest convenience.\n\nThank you.`;
    document.getElementById("payNowLink").value = "https://smartwerk.nl/pay-now";
    document.getElementById("signature").value = "Best regards,\nSmartWerk Team";

    document.querySelectorAll("input, textarea").forEach((el) => {
      if (el.value) el.classList.add("ai-filled");
    });
  });

  // Save Reminder
  document.getElementById("btn-save")?.addEventListener("click", () => {
    const reminders = JSON.parse(localStorage.getItem("savedReminders") || "[]");
    reminders.push({
      id: get("reminderId"),
      name: get("clientName"),
      email: get("clientEmail"),
      subject: get("subject"),
      body: get("messageBody"),
      amount: get("amount"),
      date: get("reminderDate"),
      dueDate: get("dueDate"),
      payNowLink: get("payNowLink"),
      signature: get("signature")
    });
    localStorage.setItem("savedReminders", JSON.stringify(reminders));
    alert("✅ Reminder saved!");
  });

  // View Saved Reminders
  document.getElementById("btn-view-saved")?.addEventListener("click", () => {
    const list = document.getElementById("savedRemindersList");
    list.innerHTML = "";
    const saved = JSON.parse(localStorage.getItem("savedReminders") || "[]");

    if (!saved.length) {
      list.innerHTML = "<p class='muted'>No saved reminders found.</p>";
    } else {
      saved.forEach((e, i) => {
        const div = document.createElement("div");
        div.className = "saved-reminder";
        div.innerHTML = `
          <strong>${e.subject}</strong> — ${e.name} (${e.date})<br/>
          <button onclick="loadReminder(${i})">📤 Load</button>
          <button onclick="deleteReminder(${i})">🗑 Delete</button>
        `;
        list.appendChild(div);
      });
    }
    document.getElementById("savedRemindersModal").style.display = "block";
  });

  // Load Reminder
  window.loadReminder = function (i) {
    const r = JSON.parse(localStorage.getItem("savedReminders") || "[]")[i];
    if (!r) return;
    document.getElementById("reminderId").value = r.id;
    document.getElementById("clientName").value = r.name;
    document.getElementById("clientEmail").value = r.email;
    document.getElementById("subject").value = r.subject;
    document.getElementById("messageBody").value = r.body;
    document.getElementById("amount").value = r.amount;
    document.getElementById("reminderDate").value = r.date;
    document.getElementById("dueDate").value = r.dueDate;
    document.getElementById("payNowLink").value = r.payNowLink;
    document.getElementById("signature").value = r.signature;
    document.getElementById("savedRemindersModal").style.display = "none";
  };

  // Delete Reminder
  window.deleteReminder = function (i) {
    const all = JSON.parse(localStorage.getItem("savedReminders") || "[]");
    all.splice(i, 1);
    localStorage.setItem("savedReminders", JSON.stringify(all));
    alert("🗑 Reminder deleted.");
    document.getElementById("btn-view-saved").click(); // Reload view
  };

  // Translate
  document.getElementById("translateBtn")?.addEventListener("click", () => {
    const lang = document.getElementById("languageSelect")?.value;
    if (lang === "nl") {
      document.getElementById("subject").placeholder = "Onderwerp";
      document.getElementById("messageBody").placeholder = "Typ je bericht...";
    } else {
      document.getElementById("subject").placeholder = "Subject";
      document.getElementById("messageBody").placeholder = "Write your message...";
    }
  });

  // Send via Email
  document.getElementById("btn-send")?.addEventListener("click", () => {
    const mailto = `mailto:${get("clientEmail")}?subject=${encodeURIComponent(
      get("subject")
    )}&body=${encodeURIComponent(
      get("messageBody") +
        "\n\n" +
        get("signature") +
        "\n\nSent via SmartWerk"
    )}`;
    window.open(mailto, "_blank");
  });

  // Export PDF with optional PRO
  document.getElementById("btn-export-pdf")?.addEventListener("click", () => {
    const withoutBrand = confirm("❓ Export without branding (PRO)?");

    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    let y = 20;

    const section = (title, content) => {
      doc.setFontSize(14);
      doc.setFont(undefined, "bold");
      doc.text(title, 14, y);
      y += 6;
      doc.setFontSize(12);
      doc.setFont(undefined, "normal");
      const lines = doc.splitTextToSize(content, 180);
      doc.text(lines, 14, y);
      y += lines.length * 6 + 4;
    };

    doc.setFontSize(18);
    doc.text("Payment Reminder", 14, y);
    y += 10;

    section("Reminder ID", get("reminderId"));
    section("Client Name", get("clientName"));
    section("Client Email", get("clientEmail"));
    section("Subject", get("subject"));
    section("Message", get("messageBody"));
    section("Amount", get("amount"));
    section("Due Date", get("dueDate"));
    section("Pay Now Link", get("payNowLink"));
    section("Signature", get("signature"));
    section("Date", get("reminderDate"));

    if (!withoutBrand) {
      doc.setFontSize(10);
      doc.setTextColor(150);
      doc.text("Generated with SmartWerk — smartwerk.nl", 14, 290);
    }

    doc.save(`Payment-Reminder-${get("clientName") || "Client"}.pdf`);
  });
});


    
  </script>
</body>
</html>
