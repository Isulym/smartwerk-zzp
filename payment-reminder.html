<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ“¬ Payment Reminder - SmartWerk</title>
  <link rel="stylesheet" href="style-payment-reminder.css"/>
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ“¬ Payment Reminder</h1>
      <p class="muted">Send professional reminders for unpaid invoices. Use AI assistance, export to PDF, or send by email.</p>
    </header>

    <!-- 1. Business Info -->
    <section>
      <h2>ğŸ§¾ Business Info (From)</h2>
      <input type="text" id="businessName" placeholder="Business Name">
      <input type="text" id="senderName" placeholder="Your Name">
      <input type="email" id="senderEmail" placeholder="Your Email">
      <input type="text" id="senderIBAN" placeholder="IBAN">
      <input type="text" id="senderAddress" placeholder="Address">
    </section>

    <!-- 2. Client Info -->
    <section>
      <h2>ğŸ‘¤ Client Info (To)</h2>
      <input type="text" id="clientName" placeholder="Client Name">
      <input type="email" id="clientEmail" placeholder="Client Email">
      <input type="text" id="clientAddress" placeholder="Client Address">
    </section>

    <!-- 3. Invoice Details -->
    <section>
      <h2>ğŸ“„ Invoice Details</h2>
      <input type="text" id="invoiceNumber" placeholder="Invoice Number">
      <input type="date" id="invoiceDate" placeholder="Invoice Date">
      <input type="date" id="dueDate" placeholder="Due Date">
      <input type="number" id="amountDue" placeholder="Amount Due (â‚¬)">
    </section>

    <!-- 4. Status & Countdown -->
    <section>
      <h2>ğŸ¯ Reminder Type</h2>
      <select id="reminderStatus">
        <option value="first">â³ First Reminder</option>
        <option value="second">âš ï¸ Second Notice</option>
        <option value="final">â— Final Reminder</option>
      </select>
      <p id="countdownNotice"></p>
    </section>

    <!-- 5. Body Message -->
    <section>
      <h2>ğŸ’¬ Message Body</h2>
      <textarea id="messageBody" placeholder="Message to the client..."></textarea>
      <div class="tone-controls">
        <button id="makeStrict">ğŸ§  Make it more strict</button>
        <button id="makeFriendly">ğŸ¤ Make it more friendly</button>
      </div>
    </section>

    <!-- 6. Date & Location -->
    <section>
      <h2>ğŸ“… Date & Location</h2>
      <input type="text" id="city" placeholder="City">
      <input type="date" id="currentDate">
    </section>

    <!-- 7. Signature -->
    <section>
      <h2>âœï¸ Signature</h2>
      <input type="text" id="signatureName" placeholder="Your Full Name">
      <input type="text" id="signatureRole" placeholder="Position (optional)">
      <input type="text" id="signatureContact" placeholder="Phone or Email (optional)">
    </section>

    <!-- 8. Payment Link -->
    <section>
      <h2>ğŸ’³ Payment</h2>
      <input type="url" id="paymentLink" placeholder="Payment Link (PayPal, Mollie, etc.)">
      <button id="payNowBtn">ğŸ’³ Pay Now</button>
    </section>

    <!-- 9. Attach Invoice -->
    <section>
      <h2>ğŸ“¥ Attach Original Invoice</h2>
      <input type="file" id="invoiceFile">
      <p id="attachedFileName"></p>
    </section>

    <!-- ACTION BUTTONS -->
    <section class="actions">
      <button id="aiFill">ğŸ¤– AI Fill</button>
      <button id="loadExample">ğŸ“‚ Load Example</button>
      <button id="translate">ğŸŒ Translate</button>
      <button id="saveReminder">ğŸ’¾ Save</button>
      <button id="savedReminders">ğŸ“¬ Saved Reminders</button>
      <button id="previewEmail">ğŸ” Preview</button>
      <button id="printReminder">ğŸ–¨ï¸ Print</button>
      <button id="sendEmail">ğŸ“¤ Send via Email</button>
      <button id="exportPDF">ğŸ“„ Export as PDF</button>
    </section>

    <!-- Footer -->
    <footer>
      <p class="muted">SmartWerk â€” smartwerk.nl | PRO features available</p>
    </footer>
  </div>

  <script>


    // payment-reminder.js â€” SmartWerk

document.addEventListener("DOMContentLoaded", () => {
  const reminderForm = document.getElementById("reminderForm");
  const todayDate = new Date().toISOString().split("T")[0];
  document.getElementById("todayDate").value = todayDate;

  // === ğŸ“Œ Auto Countdown ===
  const dueDateField = document.getElementById("dueDate");
  const countdownField = document.getElementById("dueCountdown");
  function updateCountdown() {
    const due = new Date(dueDateField.value);
    const now = new Date();
    const diff = Math.floor((due - now) / (1000 * 60 * 60 * 24));
    if (isNaN(diff)) return (countdownField.textContent = "");
    if (diff < 0) countdownField.textContent = `âš ï¸ This invoice is overdue by ${-diff} days.`;
    else if (diff === 0) countdownField.textContent = "âš ï¸ Due today.";
    else countdownField.textContent = `ğŸ’¡ Due in ${diff} days.`;
  }
  dueDateField.addEventListener("input", updateCountdown);
  updateCountdown();

  // === ğŸ¤– AI Fill ===
  document.getElementById("aiFillBtn").addEventListener("click", () => {
    const number = document.getElementById("invoiceNumber").value || "INV-2025-001";
    const due = document.getElementById("dueDate").value || todayDate;
    const amount = document.getElementById("amountDue").value || "â‚¬500";
    document.getElementById("messageBody").value = `This is a friendly reminder that invoice #${number} was due on ${due}. Please arrange payment of ${amount} at your earliest convenience.`;
    document.getElementById("messageBody").classList.add("ai-filled");
  });

  // === ğŸ“‚ Load Example ===
  document.getElementById("loadExampleBtn").addEventListener("click", () => {
    document.getElementById("businessName").value = "SmartWerk B.V.";
    document.getElementById("businessEmail").value = "info@smartwerk.nl";
    document.getElementById("businessIBAN").value = "NL91ABNA0417164300";
    document.getElementById("businessAddress").value = "Stationsstraat 12, 5211BN Den Bosch";

    document.getElementById("clientName").value = "John Client";
    document.getElementById("clientEmail").value = "john@example.com";
    document.getElementById("clientAddress").value = "Keizersgracht 123, 1015CJ Amsterdam";

    document.getElementById("invoiceNumber").value = "INV-2025-001";
    document.getElementById("invoiceDate").value = "2025-08-01";
    document.getElementById("dueDate").value = "2025-09-01";
    document.getElementById("amountDue").value = "â‚¬500";

    document.getElementById("messageBody").value = "This is a friendly reminder that invoice #INV-2025-001 was due on 01/09/2025. Please arrange payment of â‚¬500 at your earliest convenience.";
    document.getElementById("messageBody").classList.add("ai-filled");
    updateCountdown();
  });

  // === ğŸŒ Translate ===
  document.getElementById("translateBtn").addEventListener("click", () => {
    const text = document.getElementById("messageBody").value;
    if (!text) return alert("No message to translate.");
    const translated = text.replace("This is a friendly reminder", "Dit is een vriendelijke herinnering")
      .replace("Please arrange payment", "Gelieve de betaling te regelen")
      .replace("at your earliest convenience", "zo snel mogelijk");
    document.getElementById("messageBody").value = translated;
  });

  // === ğŸ’¾ Save ===
  document.getElementById("saveBtn").addEventListener("click", () => {
    const reminder = {
      businessName: document.getElementById("businessName").value,
      businessEmail: document.getElementById("businessEmail").value,
      businessIBAN: document.getElementById("businessIBAN").value,
      businessAddress: document.getElementById("businessAddress").value,
      clientName: document.getElementById("clientName").value,
      clientEmail: document.getElementById("clientEmail").value,
      clientAddress: document.getElementById("clientAddress").value,
      invoiceNumber: document.getElementById("invoiceNumber").value,
      invoiceDate: document.getElementById("invoiceDate").value,
      dueDate: document.getElementById("dueDate").value,
      amountDue: document.getElementById("amountDue").value,
      messageBody: document.getElementById("messageBody").value,
      todayDate: document.getElementById("todayDate").value,
      city: document.getElementById("city").value,
      signatureName: document.getElementById("signatureName").value,
      signatureRole: document.getElementById("signatureRole").value,
      signatureContact: document.getElementById("signatureContact").value,
      paymentURL: document.getElementById("paymentURL").value,
      status: document.getElementById("status").value,
    };
    const key = `reminder-${reminder.invoiceNumber}`;
    localStorage.setItem(key, JSON.stringify(reminder));
    alert("ğŸ’¾ Reminder saved!");
  });

  // === ğŸ“¬ View Saved Reminders ===
  document.getElementById("savedBtn").addEventListener("click", () => {
    const list = Object.keys(localStorage)
      .filter(k => k.startsWith("reminder-"))
      .map(k => `<li>${k.replace("reminder-", "")}</li>`)
      .join("");
    alert(`ğŸ“¬ Saved Reminders:
${list || "None yet."}`);
  });

  // === ğŸ–¨ï¸ Print ===
  document.getElementById("printBtn").addEventListener("click", () => window.print());

  // === ğŸ“¤ Send via Email ===
  document.getElementById("sendBtn").addEventListener("click", () => {
    const email = document.getElementById("clientEmail").value;
    const subject = `Reminder: Invoice ${document.getElementById("invoiceNumber").value}`;
    const body = document.getElementById("messageBody").value;
    if (!email || !subject || !body) return alert("Fill in all required fields.");
    window.open(`mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`, "_blank");
  });

  // === ğŸ” Preview Email ===
  document.getElementById("previewBtn").addEventListener("click", () => {
    const preview = document.getElementById("messageBody").value;
    alert("ğŸ” Preview:

" + preview);
  });

  // === ğŸ“„ Export as PDF ===
  document.getElementById("pdfBtn").addEventListener("click", async () => {
    const { jsPDF } = await import("https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js");
    const doc = new jsPDF();

    let y = 20;
    const get = (id) => document.getElementById(id).value || "-";

    doc.setFontSize(18);
    doc.text("ğŸ“¬ Payment Reminder", 14, y);
    y += 10;

    const sections = [
      ["ğŸ§¾ Business Info", `${get("businessName")}
${get("businessEmail")}
${get("businessIBAN")}
${get("businessAddress")}`],
      ["ğŸ‘¤ Client Info", `${get("clientName")}
${get("clientEmail")}
${get("clientAddress")}`],
      ["ğŸ“„ Invoice Details", `Invoice #: ${get("invoiceNumber")}
Invoice Date: ${get("invoiceDate")}
Due Date: ${get("dueDate")}
Amount Due: ${get("amountDue")}`],
      ["ğŸ’¬ Message", get("messageBody")],
      ["ğŸ“… Date & Location", `${get("todayDate")} â€” ${get("city")}`],
      ["âœï¸ Signature", `${get("signatureName")}
${get("signatureRole")}
${get("signatureContact")}`],
      ["ğŸ¨ Status", get("status")],
    ];

    for (const [title, content] of sections) {
      doc.setFontSize(14);
      doc.setFont(undefined, "bold");
      doc.text(title, 14, y);
      y += 6;
      doc.setFontSize(12);
      doc.setFont(undefined, "normal");
      const lines = doc.splitTextToSize(content, 180);
      doc.text(lines, 14, y);
      y += lines.length * 6 + 4;
    }

    doc.setFontSize(10);
    doc.setTextColor(150);
    doc.text("Generated with SmartWerk â€” smartwerk.nl", 14, 290);

    doc.save(`Payment-Reminder-${get("invoiceNumber")}.pdf`);
  });
});
    </script>
</body>
</html>
