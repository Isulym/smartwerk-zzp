<<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>📄 SmartWerk CV / Portfolio</title>
  <link rel="stylesheet" href="style-cv.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div class="cv-container">
    <header class="cv-header">
      <img src="avatar-placeholder.jpg" alt="Your Photo" class="cv-photo" id="avatarPreview" />
      <input type="file" id="avatarInput" accept="image/*" style="margin-top:10px" />
      <div class="cv-intro">
        <h1 id="namePreview">Your Name</h1>
        <p id="titlePreview">Professional Title</p>
        <p id="contactPreview">Email · Phone · Website</p>
      </div>
    </header>

    <section class="cv-summary">
      <h2>🧠 Summary</h2>
      <p id="summaryPreview">Tell us a bit about you...</p>
    </section>

    <section class="cv-skills">
      <h2>🛠️ Skills</h2>
      <ul id="skillsList"></ul>
      <input type="text" id="skillInput" placeholder="e.g. JavaScript" />
      <button onclick="addSkill()">➕ Add Skill</button>
    </section>

    <section class="cv-experience">
      <h2>💼 Experience</h2>
      <div id="experienceList"></div>
      <button onclick="addExperience()">➕ Add Experience</button>
    </section>

    <section class="cv-projects">
      <h2>📂 Projects</h2>
      <div id="projectList"></div>
      <button onclick="addProject()">➕ Add Project</button>
    </section>

    <section class="cv-education">
      <h2>🎓 Education</h2>
      <textarea id="educationInput" placeholder="e.g. Bachelor in Design, University Name"></textarea>
      <p id="educationPreview">—</p>
    </section>

    <section class="cv-languages">
      <h2>🌍 Languages</h2>
      <textarea id="languagesInput" placeholder="e.g. English (C1), Dutch (B1)"></textarea>
      <p id="languagesPreview">—</p>
    </section>

    <section class="cv-actions">
      <button id="aiFill">🤖 AI Fill</button>
      <button onclick="exportCV()">📄 Export PDF</button>
      <button onclick="clearAll()">🧹 Clear All</button>
    </section>

    <footer class="cv-footer">
      <p>🔗 smartwerk.nl/portfolio/your-name</p>
    </footer>
  </div>

  <script>
    // Avatar upload preview
    document.getElementById("avatarInput").addEventListener("change", function (e) {
      const reader = new FileReader();
      reader.onload = () => {
        document.getElementById("avatarPreview").src = reader.result;
      };
      reader.readAsDataURL(e.target.files[0]);
    });

    // Live preview bindings
    const bindInput = (id, targetId) => {
      document.getElementById(id).addEventListener("input", () => {
        document.getElementById(targetId).innerText = document.getElementById(id).value || "—";
      });
    };
    bindInput("educationInput", "educationPreview");
    bindInput("languagesInput", "languagesPreview");

    // Add skill
    function addSkill() {
      const val = document.getElementById("skillInput").value.trim();
      if (!val) return;
      const li = document.createElement("li");
      li.textContent = val;
      document.getElementById("skillsList").appendChild(li);
      document.getElementById("skillInput").value = "";
    }

    // Add experience
    function addExperience() {
      const div = document.createElement("div");
      div.innerHTML = `
        <textarea placeholder="Company, Role, Dates, Achievements"></textarea>
        <hr />
      `;
      document.getElementById("experienceList").appendChild(div);
    }

    // Add project
    function addProject() {
      const div = document.createElement("div");
      div.innerHTML = `
        <textarea placeholder="Project name, Description, Link..."></textarea>
        <hr />
      `;
      document.getElementById("projectList").appendChild(div);
    }

    // Export to PDF
    async function exportCV() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      let y = 20;

      doc.setFontSize(18);
      doc.text("SmartWerk CV", 20, y);
      y += 10;
      doc.setFontSize(12);

      function write(title, value) {
        if (!value) return;
        doc.setFont(undefined, "bold");
        doc.text(title, 20, y);
        y += 6;
        doc.setFont(undefined, "normal");
        const lines = doc.splitTextToSize(value, 170);
        doc.text(lines, 20, y);
        y += lines.length * 6 + 4;
      }

      write("Name", document.getElementById("namePreview").innerText);
      write("Title", document.getElementById("titlePreview").innerText);
      write("Contact", document.getElementById("contactPreview").innerText);
      write("Summary", document.getElementById("summaryPreview").innerText);

      let skills = [...document.querySelectorAll("#skillsList li")].map(li => li.textContent).join(", ");
      write("Skills", skills);

      let experiences = [...document.querySelectorAll("#experienceList textarea")].map(t => t.value).join("\n\n");
      write("Experience", experiences);

      let projects = [...document.querySelectorAll("#projectList textarea")].map(t => t.value).join("\n\n");
      write("Projects", projects);

      write("Education", document.getElementById("educationInput").value);
      write("Languages", document.getElementById("languagesInput").value);

      doc.save("smartwerk-cv.pdf");
    }

    // Clear All
    function clearAll() {
      document.querySelectorAll("textarea, input[type='text']").forEach(el => el.value = "");
      document.getElementById("skillsList").innerHTML = "";
      document.getElementById("experienceList").innerHTML = "";
      document.getElementById("projectList").innerHTML = "";
      document.getElementById("educationPreview").innerText = "—";
      document.getElementById("languagesPreview").innerText = "—";
    }

    // AI Fill Demo
    document.getElementById("aiFill").addEventListener("click", () => {
      document.getElementById("namePreview").innerText = "Igor Sulima";
      document.getElementById("titlePreview").innerText = "Digital Entrepreneur & Tax Automation Expert";
      document.getElementById("contactPreview").innerText = "igor@smartwerk.nl · +31 6 12345678 · smartwerk.nl";
      document.getElementById("summaryPreview").innerText = "Visionary founder of SmartWerk, building AI tools for freelancers and small businesses in NL.";
      document.getElementById("educationInput").value = "BSc in Business & IT, Utrecht University";
      document.getElementById("languagesInput").value = "Dutch (B2), English (C1)";
      bindInput("educationInput", "educationPreview");
      bindInput("languagesInput", "languagesPreview");

      ["JavaScript", "AI Integration", "UX Design"].forEach(skill => {
        const li = document.createElement("li");
        li.textContent = skill;
        document.getElementById("skillsList").appendChild(li);
      });

      const exp = document.createElement("div");
      exp.innerHTML = `<textarea>SmartWerk, Founder, 2023–Now\n- Created tax calculator used by 1000+ freelancers\n- Led product & design</textarea><hr/>`;
      document.getElementById("experienceList").appendChild(exp);
    });

// ⏬ Smart Drag-and-Drop Reordering for CV / Portfolio Sections

document.addEventListener("DOMContentLoaded", function () {
  const container = document.querySelector(".cv-container");
  const sections = container.querySelectorAll("section");

  // Відновлення порядку з localStorage
  const savedOrder = JSON.parse(localStorage.getItem("cvSectionOrder") || "[]");
  if (savedOrder.length) {
    savedOrder.forEach(id => {
      const sec = document.getElementById(id);
      if (sec) container.appendChild(sec);
    });
  }

  // Додаємо draggable і обробники
  sections.forEach(section => {
    section.setAttribute("draggable", true);
    section.style.cursor = "move";

    section.addEventListener("dragstart", (e) => {
      e.dataTransfer.setData("text/plain", section.id);
      section.classList.add("dragging");
    });

    section.addEventListener("dragend", () => {
      section.classList.remove("dragging");
      saveSectionOrder();
    });

    section.addEventListener("dragover", (e) => {
      e.preventDefault();
      const dragging = container.querySelector(".dragging");
      if (!dragging || dragging === section) return;

      const rect = section.getBoundingClientRect();
      const next = (e.clientY - rect.top) / (rect.bottom - rect.top) > 0.5;
      container.insertBefore(dragging, next ? section.nextSibling : section);
    });
  });

  function saveSectionOrder() {
    const order = Array.from(container.querySelectorAll("section")).map(sec => sec.id);
    localStorage.setItem("cvSectionOrder", JSON.stringify(order));
  }
});
  </script>
</body>
</html>
